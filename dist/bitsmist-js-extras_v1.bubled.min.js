!function(){"use strict";var e=function(e){function t(t){e.call(this,Object.assign({notifyOnChange:!0,async:!1},t)),this._filter,this._observers=[],this.filter=BITSMIST.v1.Util.safeGet(this._options,"filter",(function(){return!0}))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={filter:{configurable:!0}};return r.filter.get=function(){return this._filter},r.filter.set=function(e){BITSMIST.v1.Util.assert("function"==typeof e,"Store.filter(setter): Filter is not a function. filter="+e,TypeError),this._filter=e},t.prototype.set=function(e,t,r){var n={},o=e?this.get(e):this._items;if(o&&"object"==typeof o?this.__deepMerge(o,t,n):this.get(e)!==t&&(BITSMIST.v1.Util.safeSet(this._items,e,t),n[e]=t),BITSMIST.v1.Util.safeGet(r,"notifyOnChange",BITSMIST.v1.Util.safeGet(this._options,"notifyOnChange"))&&Object.keys(n).length>0)return this.notify(n)},t.prototype.replace=function(e,t){if(this._items={},this.__deepMerge(this._items,e),BITSMIST.v1.Util.safeGet(t,"notifyOnChange",BITSMIST.v1.Util.safeGet(this._options,"notifyOnChange")))return this.notify("*")},t.prototype.subscribe=function(e,t,r){BITSMIST.v1.Util.assert("function"==typeof t,"ObservableStore.subscribe(): Notification handler is not a function. id="+e,TypeError),this._observers.push({id:e,handler:t,options:r})},t.prototype.unsubscribe=function(e){for(var t=0;t<this._observers.length;t++)if(this._obvservers[t].id===e){this._observers.splice(t,1);break}},t.prototype.notify=function(e){for(var t,r,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];return BITSMIST.v1.Util.safeGet(this._options,"async",!1)?(t=this).notifyAsync.apply(t,[e].concat(n)):(r=this).notifySync.apply(r,[e].concat(n))},t.prototype.notifySync=function(e){for(var t=this,r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];for(var o=Promise.resolve(),i=function(n){o=o.then((function(){var o,i;if((o=t)._filter.apply(o,[e,t._observers[n]].concat(r)))return(i=t._observers[n]).handler.apply(i,[e].concat(r))}))},a=0;a<t._observers.length;a++)i(a);return o},t.prototype.notifyAsync=function(e){for(var t,r,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];for(var i=0;i<this._observers.length;i++)(t=this)._filter.apply(t,[e,this._observers[i].options].concat(n))&&(r=this._observers[i]).handler.apply(r,[e].concat(n));return Promise.resolve()},t.prototype.mute=function(){this._options.notifyOnChange=!1},t.prototype.unmute=function(){this._options.notifyOnChange=!0},t.prototype.__deepMerge=function(e,t,r){return r=r||{},BITSMIST.v1.Util.assert(e&&"object"==typeof e&&t&&"object"==typeof t,"ObservableStore.__deepMerge(): Parameters must be an object.",TypeError),Object.keys(t).forEach((function(n){Array.isArray(e[n])?(e[n]=e[n].concat(t[n]),r[n]=e[n]):e.hasOwnProperty(n)&&e[n]&&"object"==typeof e[n]&&t[n]&&"object"==typeof t[n]&&!(e[n]instanceof HTMLElement)?Util.deepMerge(e[n],t[n]):e[n]!==t[n]&&(e[n]=t[n],r[n]=e[n])})),e},Object.defineProperties(t.prototype,r),t}(BITSMIST.v1.ChainableStore);function t(){}function r(){}t.format=function(e,r,n){var o=n;switch(r.toLowerCase()){case"yyyy/mm/dd":o=t.formatDate(r,o);break;case"price":o=t.formatPrice(r,o)}return o},t.formatPrice=function(e,t){return t?"¥"+String(parseInt(t)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):""},t.formatNumber=function(e){return e?String(parseInt(e)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):""},t.formatDate=function(e,t){var r="";return t&&8===t.length&&(r=t.substr(0,4)+"/"+t.substr(4,2)+"/"+t.substr(6,2)),r},t.deformat=function(e,r,n){var o=n;switch(r){case"yyyy/mm/dd":o=t.deformatDate(r,n);break;case"price":o=t.deformatPrice(r,n)}return o},t.deformatPrice=function(e,t){var r="";return t&&(r=t.replace(/,/g,"").replace(/\//g,"").replace(/\\/g,"").replace("¥","")),r},t.deformatDate=function(e,t){var r="";return t&&(r=t.replace(/,/g,"").replace(/\//g,"").replace(/\\/g,"")),r},t.getNow=function(e){e=e||"-";var t=new Date;return t.getFullYear()+e+("00"+(t.getMonth()+1)).slice(-2)+e+("00"+t.getDate()).slice(-2)+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2)},t.getToday=function(e){e=void 0===e?"-":e;var t=new Date;return t.getFullYear()+e+("00"+(t.getMonth()+1)).slice(-2)+e+("00"+t.getDate()).slice(-2)},t.sanitize=function(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):e},r.showConditionalElements=function(e,t){BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-visible]").forEach((function(e){var r=e.getAttribute("bm-visible");BITSMIST.v1.Util.safeEval(r,t,t)?e.style.removeProperty("display"):e.style.display="none"}))},r.hideConditionalElements=function(e){BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-visible]").forEach((function(e){e.style.display="none"}))},r.setFields=function(e,n,o){var i=BITSMIST.v1.Util.safeGet(o,"masters"),a=BITSMIST.v1.Util.safeGet(o,"triggerEvent"),s=BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-bind]");s.push(e),s.forEach((function(e){var o=e.getAttribute("bm-bind");if(o in n){var s=BITSMIST.v1.Util.safeGet(n,o,"");if(e.hasAttribute("bm-bindtext")){var c=e.getAttribute("bm-bindtext").split("."),u=c[0],l=c[1]||"";s=r._getMasterValue(i,u,n[o],l)}if(e.hasAttribute("bm-format")&&(s=t.format("",e.getAttribute("bm-format"),s)),r.setValue(e,s),a){var p=document.createEvent("HTMLEvents");p.initEvent(a,!0,!0),e.dispatchEvent(p)}}}))},r.getFields=function(e){var t={},n=BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-bind]");return n.push(e),n.forEach((function(e){var n=e.getAttribute("bm-bind"),o=r.getValue(e);if(e.hasAttribute("bm-format")&&(o=BITSMIST.v1.FormatterUtil.deformat("",e.getAttribute("bm-format"),o)),Array.isArray(t[n]))o&&t[n].push(o);else if(t[n]){if(o){var i=[];i.push(t[n]),i.push(o),t[n]=i}}else t[n]=o})),t},r.clearFields=function(e,t){t=t||"";var r=BITSMIST.v1.Util.scopedSelectorAll(e,t+" input");r.forEach((function(e){switch(e.type.toLowerCase()){case"search":case"text":case"number":e.value="";break;case"checkbox":case"radio":e.checked=!1}})),r=e.querySelectorAll(t+" select"),(r=Array.prototype.slice.call(r,0)).forEach((function(e){e.selectedIndex=-1}))},r.setValue=function(e,t){null==t&&(t="");var n=e.getAttribute("bm-bindtarget");n?r._setValue_target(e,n,t):e.hasAttribute("value")?r._setValue_value(e,t):r._setValue_element(e,t)},r.build=function(e,t,n){if("select"===e.tagName.toLowerCase())r._build_select(e,t,n)},r.getValue=function(e){var t=void 0;switch(e.tagName.toLowerCase()){case"input":switch(e.type.toLowerCase()){case"radio":case"checkbox":e.checked&&(t=e.hasAttribute("value")?e.getAttribute("value"):e.checked);break;default:t=e.value}break;case"select":t=e.value;break;default:e.hasAttribute("selected")&&(t=e.getAttribute("value"))}return t},r._build_select=function(e,t,r){if(r=r||{},e.options.length=0,"emptyItem"in r){var n="text"in r.emptyItem?r.emptyItem.text:"",o="value"in r.emptyItem?r.emptyItem.value:"",i=document.createElement("option");i.text=n,i.value=o,i.setAttribute("selected",""),e.appendChild(i)}Object.keys(t).forEach((function(n){var o=document.createElement("option");o.text=r.text?t[n][r.text]:n,o.value=r.value?t[n][r.value]:n,e.appendChild(o)})),"defaultValue"in r&&(e.value=r.defaultValue)},r._build_radio=function(e,t,r){Object.keys(r.items).forEach((function(e){var t=document.createElement("label"),n=document.createElement("input");n.type="radio",n.id=key,n.name=key,n.value=e,n.setAttribute("bm-bind",key),n.setAttribute("bm-submit",""),t.appendChild(n),t.appendChild(document.createTextNode(r.items[e].title)),element.appendChild(t)}))},r._setValue_target=function(e,t,r){for(var n=t.split(","),o=0;o<n.length;o++){var i=n[o].toLowerCase();switch(i){case"text":e.innerText=r;break;case"html":e.innerHTML=r;break;case"outerhtml":r&&(e.outerHTML=r);break;case"href":case"src":case"rel":"http"!==r.substring(0,4)&&"/"!==r.substring(0,1)||e.setAttribute(i,r);break;default:var a=e.getAttribute(i);a=a?a+" "+r:r,e.setAttribute(i,a)}}},r._setValue_value=function(e,t){"input"===e.tagName.toLowerCase()&&"checkbox"===e.type.toLowerCase()||"input"===e.tagName.toLowerCase()&&"radio"===e.type.toLowerCase()?Array.isArray(t)?t.indexOf(e.getAttribute("value"))>-1&&(e.checked=!0):e.getAttribute("value")===t&&(e.checked=!0):e.setAttribute("value",t)},r._setValue_element=function(e,t){if("select"===e.tagName.toLowerCase())e.value=t;else if("input"===e.tagName.toLowerCase())switch(e.type.toLowerCase()){case"number":case"search":case"text":e.value=t;break;case"checkbox":e.checked=!!t;break;case"radio":e.value===t&&(e.checked=!0)}else e.innerText=t},r._getMasterValue=function(e,t,r,n){var o=r;if(e&&t in e){var i=e[t].getItem(r);i&&(o=i[n])}return o};var n=function(e){function t(t){e.call(this,t),this.filter=function(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];var o=!1;return("*"===e||e.indexOf(t.id)>-1)&&(o=!0),o}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.bindTo=function(e){var t=this,n=e.getAttribute("bm-bind");if(!!(!e.__bm_bindinfo||!e.__bm_bindinfo.bound)&&BITSMIST.v1.Util.safeGet(this._options,"2way",!0)){this.subscribe(n,(function(){r.setValue(e,t.get(n))}));var o=BITSMIST.v1.Util.safeGet(this._options,"eventName","change");e.addEventListener(o,function(){t.set(n,r.getValue(e),{notifyOnChange:!1})}.bind(this)),e.__bm_bindinfo={bound:!0}}},t}(e),o=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.organize=function(e,t,r){var n=[],o=r.files;return o&&Object.keys(o).forEach((function(e){n.push(BITSMIST.v1.AjaxUtil.loadScript(o[e].href))})),Promise.all(n)},t}(BITSMIST.v1.Organizer),i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.globalInit=function(){t._observers=new BITSMIST.v1.ObservableStore({filter:t.__filter}),document.addEventListener("DOMContentLoaded",(function(){BITSMIST.v1.settings.get("organizers.ErrorOrganizer.settings.captureError",!0)&&t.__initErrorListeners()}))},t.organize=function(e,r,n){n.errors&&t._observers.subscribe(r.uniqueId,r.trigger.bind(r),{component:r})},t.__filter=function(e,t,r){for(var n=!1,o=t.component.settings.get("errors.targets"),i=0;i<o.length;i++)if(r.error.name===o[i]||"*"===o[i]){n=!0;break}return n},t.__initErrorListeners=function(){window.addEventListener("unhandledrejection",(function(e){var r={};return e.reason?e.reason instanceof XMLHttpRequest?(r.message=e.reason.statusText,r.stack=e.reason.stack,r.object=e.reason):(r.message=e.reason.message,r.object=e.reason):r.message=e,r.type=e.type,r.name=t.__getErrorName(e),r.filename="",r.funcname="",r.lineno="",r.colno="",t.__handleException(r),!1})),window.addEventListener("error",(function(e,r,n,o){var i={type:"error"};return i.name=t.__getErrorName(e),i.message=e.message,i.file=e.filename,i.line=e.lineno,i.col=e.colno,e.error&&(i.stack=e.error.stack,i.object=e.error),t.__handleException(i),!1}))},t.__getErrorName=function(e){var t,r;if((r=e.reason instanceof XMLHttpRequest||e.reason?e.reason:e.error?e.error:e.message).name)t=r.name;else if(r instanceof TypeError)t="TypeError";else if(r instanceof XMLHttpRequest)t="AjaxError";else if(r instanceof EvalError)t="EvalError";else if(r instanceof RangeError)t="RangeError";else if(r instanceof ReferenceError)t="ReferenceError";else if(r instanceof SyntaxError)t="SyntaxError";else if(r instanceof URIError)t="URIError";else{var n=r.indexOf(":");n>-1&&(t=r.substring(0,n))}return t},t.__handleException=function(e){return t._observers.notifyAsync("error",{sender:t,error:e})},t}(BITSMIST.v1.Organizer),a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.organize=function(e,r,n){var o=n.elements;o&&Object.keys(o).forEach((function(e){r.addEventHandler(e,{handler:t.onDoOrganize,options:{attrs:o[e]}})}))},t.onDoOrganize=function(e,r,n){var o=n.component,i=n.options.attrs;Object.keys(i).forEach((function(e){t.__initAttr(o,e,i[e])}))},t.__getTargetElements=function(e,t,r){return r.rootNode?"this"===r.rootNode||r.rootNode===e.tagName.toLowerCase()?[e]:e.querySelectorAll(r.rootNode):"this"===t||t===e.tagName.toLowerCase()?[e]:e.querySelectorAll("#"+t)},t.__initAttr=function(e,n,o){if(o)for(var i=t.__getTargetElements(e,n,o),a=function(t){Object.keys(o).forEach((function(n){switch(n){case"build":var a=o[n].resourceName;r.build(i[t],e.resources[a].items,o[n]);break;case"attribute":Object.keys(o[n]).forEach((function(e){i[t].setAttribute(e,o[n][e])}));break;case"style":Object.keys(o[n]).forEach((function(e){i[t].style[e]=o[n][e]}));break;case"property":Object.keys(o[n]).forEach((function(e){i[t][e]=o[n][e]}));break;case"autoFocus":i[t].focus()}}))},s=0;s<i.length;s++)a(s)},t}(BITSMIST.v1.Organizer),s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.init=function(e,r){Object.defineProperty(e,"resources",{get:function(){return this._resources}}),e.addResource=function(e,r){return t._addResource(this,e,r)},e.switchResource=function(e){return t._switchResource(this,e)},e._resources={}},t.organize=function(e,r,n){var o=[];switch(e){case"beforeStart":case"afterSpecLoad":var i=n.resources;i&&Object.keys(i).forEach((function(e){var n=BITSMIST.v1.Util.safeGet(i[e],"handlerOptions.resourceName",e),a=t._addResource(r,n,i[e]);if(a.options.get("autoLoad")){var s=a.options.get("autoLoadOptions.id"),c=a.options.get("autoLoadOptions.parameters");o.push(r._resources[e].get(s,c))}}));break;case"doFetch":o.push(t.doFetch(r,n));break;case"doSubmit":o.push(t.doSubmit(r,n))}return Promise.all(o)},t._addResource=function(e,t,r){var n;return r.handlerClassName&&(n=BITSMIST.v1.ClassUtil.createObject(r.handlerClassName,e,t,r.handlerOptions),e._resources[t]=n),n},t._switchResource=function(e){this._defaultResource=this._resources[e]},t.doFetch=function(e,r){for(var n=[],o=t.__getTargetResources(e,r,"autoFetch"),i=0;i<o.length;i++){var a=o[i],s=BITSMIST.v1.Util.safeGet(r,"id",e._resources[a].target.id),c=BITSMIST.v1.Util.safeGet(r,"parameters",e._resources[a].target.parameters);e._resources[a].target.id=s,e._resources[a].target.parameters=c,n.push(e._resources[a].get(s,c))}return Promise.all(n).then((function(){var t=e.settings.get("settings.resourceName");t&&e._resources[t]&&(e.items=e._resources[t].items,e.item=e._resources[t].item)}))},t.doSubmit=function(e,r){var n=[],o={},i=t.__getTargetResources(e,r,"autoSubmit"),a=e.querySelectorAll("[bm-submit]");(a=Array.prototype.slice.call(a,0)).forEach((function(t){var r=t.getAttribute("bm-bind");o[r]=e.item[r]}));for(var s=0;s<i.length;s++){var c=i[s],u=BITSMIST.v1.Util.safeGet(r,"method",e._resources[c].target.method||"put"),l=BITSMIST.v1.Util.safeGet(r,"id",e._resources[c].target.id),p=BITSMIST.v1.Util.safeGet(r,"parameters",e._resources[c].target.parameters);n.push(e._resources[c][u](l,o,p))}return Promise.all(n)},t.__getTargetResources=function(e,t,r){var n=BITSMIST.v1.Util.safeGet(t,r,e.settings.get("settings."+r,[]));return Array.isArray(n)||("string"==typeof n?n=[e.settings.get("settings."+r)]:!0===n&&e.settings.get("settings.resourceName")&&(n=[e.settings.get("settings.resourceName")])),n},t}(BITSMIST.v1.Organizer),c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.init=function(e,r){Object.defineProperty(e,"validators",{get:function(){return this._validators}}),Object.defineProperty(e,"validationResult",{get:function(){return this._validationResult}}),e.addValidator=function(e,r){return t._addValidator(this,e,r)},e._validators={},e._validationResult={}},t.organize=function(e,r,n){switch(e){case"doCheckValidity":case"doReportValidity":var o=n.validationName;if(o){var i=BITSMIST.v1.Util.safeGet(n,"item"),a=r.settings.get("validations."+o+".rules"),s=r.settings.get("validations."+o+".handlerOptions"),c="doCheckValidity"===e?"checkValidity":"reportValidity";BITSMIST.v1.Util.assert(r._validators[o],"ValidationOrganizer.organize(): Validator not found. name="+r.name+", validationName="+o),r._validators[o][c](i,a,s)}break;default:var u=n.validations;u&&Object.keys(u).forEach((function(e){t._addValidator(r,e,u[e])}))}},t._addValidator=function(e,t,r){var n;return r.handlerClassName&&(n=BITSMIST.v1.ClassUtil.createObject(r.handlerClassName,e,t,r),e._validators[t]=n),n},t}(BITSMIST.v1.Organizer),u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.init=function(e,r){Object.defineProperty(e,"binds",{get:function(){return this._binds},set:function(e){t.update(this,e)}}),e.bindData=function(e){return t._bindData(this,e)},e.update=function(e){return t._update(this,e)},e._binds=new n},t.organize=function(e,r,n){switch(e){case"afterAppend":t._bindData(r);break;case"afterFetch":var o=n.bindings;o&&t.setResource(r,o)}},t.setResource=function(e,t){var r=t.resourceName;e._binds.replace(e.resources[r].item)},t.update=function(e,r){e._binds.items=r,t._bindData(e)},t._bindData=function(e,t){var r=(t=t||e).querySelectorAll("[bm-bind]");(r=Array.prototype.slice.call(r,0)).forEach((function(t){e._binds.bindTo(t)}))},t}(BITSMIST.v1.Organizer),l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.init=function(e,t){e._plugins={}},t.organize=function(e,r,n){var o=n.plugins;o&&Object.keys(o).forEach((function(e){t._addPlugin(r,e,o[e])}))},t._addPlugin=function(e,t,r){var n,o="className"in(r=Object.assign({},r))?r.className:t;return n=BITSMIST.v1.ClassUtil.createObject(o,e,r),e._plugins[t]=n,n},t}(BITSMIST.v1.Organizer),p=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.init=function(e,t){e.__isComposing=!1},t.organize=function(e,r,n){var o=n.keys;if(o){var i=t.__getActions(o);r.addEventListener("keydown",(function(e){t.onKeyDown.call(this,e,r)})),r.addEventListener("keyup",(function(e){t.onKeyUp.call(this,e,r,o,i)})),Object.keys(o).forEach((function(e){t.__initButtons(r,e,o[e])}))}},t.onKeyDown=function(e,t){t.__isComposing=229===e.keyCode},t.onKeyUp=function(e,r,n,o){if(!r.__isComposing){var i=e.key?e.key:t.__getKeyfromKeyCode(e.keyCode);switch(i){case"Esc":i="Escape";break;case"Down":i="ArrowDown";break;case"Up":i="ArrowUp";break;case"Left":i="ArrowLeft";break;case"Right":i="ArrowRight"}o[i=i.toLowerCase()]&&o[i].handler.call(this,e,r,o[i].option)}},t._defaultSubmit=function(e,t,r){t.submit().then((function(){t.cancelSubmit||(t._isModal&&(t.modalResult.result=!0),r&&r.autoClose&&t.close())}))},t._defaultCancel=function(e,t,r){t.close()},t._defaultClear=function(e,t,r){var n;this.hasAttribute("bm-cleartarget")&&(n=this.getAttribute("bm-cleartarget")),t.clear(n)},t.__getKeyfromKeyCode=function(e){var t;if(13===e)t="Enter";else t=String.fromCharCode(e);return t},t.__initButtons=function(e,r,n){if(n&&n.rootNode){var o=n.handler?n.handler:t.__getDefaultHandler(r),i=e.querySelectorAll(n.rootNode);(i=Array.prototype.slice.call(i,0)).forEach((function(t){t.addEventListener("click",(function(t){o.call(this,t,e,n)}))}))}},t.__getActions=function(e){var r={};return Object.keys(e).forEach((function(n){for(var o=Array.isArray(e[n].key)?e[n].key:[e[n].key],i=0;i<o.length;i++)r[o[i]]={},r[o[i]].type=n,r[o[i]].handler=e[n].handler?e[n].handler:t.__getDefaultHandler(n),r[o[i]].option=e[n]})),r},t.__getDefaultHandler=function(e){var r;switch(e){case"submit":r=t._defaultSubmit;break;case"clear":r=t._defaultClear;break;case"cancel":r=t._defaultCancel}return r},t}(BITSMIST.v1.Organizer),f=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.organize=function(e,r,n){var o=n.chains;o&&Object.keys(o).forEach((function(e){r.addEventHandler(e,{handler:t.onDoOrganize,options:o[e]})}))},t.unorganize=function(e,r,n){var o=n.chains;o&&Object.keys(o).forEach((function(e){r.removeEventHandler(e,{handler:t.onDoOrganize,options:o[e]})}))},t.onDoOrganize=function(e,r,n){for(var o=n.component,i=n.options,a=[],s=Promise.resolve(),c=function(e){var n=i[e].method||"refresh",c=i[e].state||"started",u=i[e].sync,l=document.querySelectorAll(i[e].rootNode);l=Array.prototype.slice.call(l,0),BITSMIST.v1.Util.assert(l.length>0,"ChainOrganizer.onDoOrganizer(): Node not found. name="+o.name+", eventName="+r.type+", rootNode="+i[e].rootNode+", method="+n),s=u?s.then((function(){return t.__execTarget(o,l,n,c)})):t.__execTarget(o,l,n,c),a.push(s)},u=0;u<i.length;u++)c(u);return s.then((function(){return Promise.all(a)}))},t.__execTarget=function(e,t,r,n){var o=[];return t.forEach((function(t){var i=e.waitFor([{object:t,state:n}]).then((function(){return t[r]({sender:e})}));o.push(i)})),Promise.all(o)},t}(BITSMIST.v1.Organizer),d=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.init=function(e,r){Object.defineProperty(e,"modalResult",{get:function(){return this._modalResult}}),Object.defineProperty(e,"isModal",{get:function(){return this._isModal}}),e.open=function(e){return t._open(this,e)},e.openModal=function(e){return t._openModal(this,e)},e.close=function(e){return t._close(this,e)},e._isModal=!1,e._modalResult,e._modalPromise},t.organize=function(e,t,r){switch(r.dialog,e){case"beforeStart":t.settings.set("settings.autoRefresh",!1),t.settings.set("settings.autoRefreshOnOpen",!0),t.settings.set("settings.autoSetup",!1),t.settings.set("settings.autoSetupOnOpen",!0);break;case"afterStart":t.settings.get("settings.autoOpen")&&t.open()}},t._open=function(e,t){return t=Object.assign({},t),Promise.resolve().then((function(){return e.trigger("beforeOpen",t)})).then((function(){if(BITSMIST.v1.Util.safeGet(t,"autoSetupOnOpen",e.settings.get("settings.autoSetupOnOpen")))return e.setup(t)})).then((function(){if(BITSMIST.v1.Util.safeGet(t,"autoRefreshOnOpen",e.settings.get("settings.autoRefreshOnOpen")))return e.refresh(t)})).then((function(){return e.trigger("doOpen",t)})).then((function(){var t=e.settings.get("settings.autoFocus");if(t){var r=!0===t?e:e.querySelector(t);r&&r.focus()}})).then((function(){return e.trigger("afterOpen",t)})).then((function(){}))},t._openModal=function(e,r){return new Promise((function(n,o){e._isModal=!0,e._modalResult={result:!1},e._modalPromise={resolve:n,reject:o},t._open(e,r)}))},t._close=function(e,t){return t=Object.assign({},t),Promise.resolve().then((function(){return e.trigger("beforeClose",t)})).then((function(){return e.trigger("doClose",t)})).then((function(){return e.trigger("afterClose",t)})).then((function(){e._isModal&&e._modalPromise.resolve(e._modalResult)})).then((function(){}))},t}(BITSMIST.v1.Organizer),h=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.globalInit=function(){r._defaults=new BITSMIST.v1.ChainableStore,r._store=new e({chain:r._defaults,filter:r._filter,async:!0}),r.__loaded={},r.__loaded.promise=new Promise((function(e,t){r.__loaded.resolve=e,r.__loaded.reject=t}))},r.init=function(e,t){r._store.subscribe(e.name+"_"+e.uniqueId,r._triggerEvent.bind(e),{targets:BITSMIST.v1.Util.safeGet(t,"preferences.targets")})},r.organize=function(e,t,n){var o,i=Promise.resolve();return BITSMIST.v1.Util.safeGet(n,"preferences.defaults")&&(r._defaults.items=t.settings.get("preferences.defaults")),BITSMIST.v1.Util.safeGet(n,"preferences.settings.load")&&(i=t.resources.preferences.get().then((function(e){r._store.merge(e),r.__loaded.resolve()}))),i.then((function(){var e=t.settings.get("system.preferenceTimeout",1e4);return o=setTimeout((function(){throw new ReferenceError("Time out waiting for loading preferences. name="+t.name)}),e),r.__loaded.promise})).then((function(){clearTimeout(o)}))},r._triggerEvent=function(e){var t=this.settings.get("preferences.settings.eventName","doSetup");return this.trigger(t,{sender:r,item:e})},r._filter=function(e,t){var r=!1,n=t.targets;if("*"===n)r=!0;else{n=Array.isArray(n)?n:[n];for(var o=0;o<n.length;o++)if(e[n[o]]){r=!0;break}}return r},r}(BITSMIST.v1.Organizer),g=function(e,t){var r=this;this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},t)}),this._options.merge(this._getOptions()),this._options.set("name",this._options.get("name",this.constructor.name));var n=this._options.get("events",{});if(Object.keys(n).forEach((function(t){e.addEventHandler(t,n[t],null,r)})),this._options.get("expose")){var o=this;Object.defineProperty(e.__proto__,this._options.get("expose"),{get:function(){return o}})}},m={name:{configurable:!0},component:{configurable:!0}};m.name.get=function(){return this._options.get("name")},m.component.get=function(){return this._component},m.component.set=function(e){this._component=e},g.prototype._getOptions=function(){return{}},Object.defineProperties(g.prototype,m);var _=function(e,t,r){this._resourceName=t,this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},r)}),this._data,this._name="ResourceHandler",this._items=[],this._item={},this._target={},this._currentIndex=0},v={name:{configurable:!0},resourceName:{configurable:!0},target:{configurable:!0},data:{configurable:!0},items:{configurable:!0},item:{configurable:!0},options:{configurable:!0}};v.name.get=function(){return this._name},v.name.set=function(e){this._name=e},v.resourceName.get=function(){return this._resourceName},v.resourceName.set=function(e){this._resourceName=e},v.target.get=function(){return this._target},v.data.get=function(){return this._data},v.data.set=function(e){this._data=e,this._items=this.__reshapeItems(e),this._item=Array.isArray(this._items)?this._items[this._currentIndex]:this._items},v.items.get=function(){return this._items},v.item.get=function(){return this._item},v.options.get=function(){return this._options},_.prototype.get=function(e,t){var r=this;return Promise.resolve().then((function(){return r._get(e,t)})).then((function(e){return e&&(r.data=e),r._data}))},_.prototype.delete=function(e,t){var r=this;return Promise.resolve().then((function(){return r._delete(e,t)}))},_.prototype.post=function(e,t,r){var n=this;return t=this.__reshapeData(t),Promise.resolve().then((function(){return n._post(e,t,r)}))},_.prototype.put=function(e,t,r){var n=this;return t=this.__reshapeData(t),Promise.resolve().then((function(){return n._put(e,t,r)}))},_.prototype.getText=function(e){var t=e,r=this._options.get("fieldOptions.text");return this._items&&e in this._items&&(t=this._items[e][r]),t},_.prototype.getItem=function(e){var t;return this._items&&e in this._items&&(t=this._items[e]),t},_.prototype._get=function(e,t){},_.prototype._delete=function(e,t){},_.prototype._post=function(e,t,r){},_.prototype._put=function(e,t,r){},_.prototype.__reshapeItems=function(e){var t=this._options.get("fieldOptions.items"),r=t?BITSMIST.v1.Util.safeGet(e,t):e;this._options.get("reshapeOptions.get.reshape")&&(r=this._options.get("reshapeOptions.get.reshaper",this.__reshaper_get.bind(this))(r));return r},_.prototype.__reshapeData=function(e){if(this._options.get("reshapeOptions.put.reshape")){var t=this._options.get("reshapeOptions.put.reshaper",(function(){return e}));e=t(e)}return e},_.prototype.__reshaper_get=function(e){var t=this._options.get("fieldOptions.id");return e.reduce((function(e,r){return e[r[t]]=r,e}),{})},Object.defineProperties(_.prototype,v);var y=function(e){function t(t,r,n){e.call(this,t,r,Object.assign({autoLoad:!0},n)),this._name="CookieResourceHandler",this._cookieName=BITSMIST.v1.Util.safeGet(n,"cookieOptions.name","preferences")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._get=function(e,t){return this.__getCookie(this._cookieName)},t.prototype._put=function(e,t,r){this.__setCookie(this._cookieName,t)},t.prototype.__getCookie=function(e){var t=document.cookie.split(";").reduce((function(e,t){var r=t.split("="),n=r[0],o=r[1];return n&&(e[n.trim()]=o?decodeURIComponent(o.trim()):void 0),e}),{});return t[e]?JSON.parse(t[e]):{}},t.prototype.__setCookie=function(e,t){var r=e+"="+encodeURIComponent(JSON.stringify(t))+"; ",n=this._options.get("cookieOptions");r+=Object.keys(n).reduce((function(e,t){return e+=t+"="+n[t]+"; "}),""),document.cookie=r},t}(_),b=function(e){function t(t,r,n){e.call(this,t,r,n),this._name="ApiResourceHandler"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._get=function(e,t){var r=this,n="GET",o=this._getOption("headers",n),i=this._getOption("options",n),a=this._getOption("url",n),s=a.dataType,c=this._buildApiUrl(this._resourceName,e,t,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:c,method:n,headers:o,options:i}).then((function(e){return r._convertResponseData(e.responseText,s)}))},t.prototype._delete=function(e,t){var r="DELETE",n=this._getOption("headers",r),o=this._getOption("options",r),i=this._getOption("url",r);i.dataType;var a=this._buildApiUrl(this._resourceName,e,t,i);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:a,method:r,headers:n,options:o})},t.prototype._post=function(e,t,r){var n="POST",o=this._getOption("headers",n),i=this._getOption("options",n),a=this._getOption("url",n),s=a.dataType,c=this._buildApiUrl(this._resourceName,e,r,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:c,method:n,headers:o,options:i,data:this._convertRequestData(t,s)})},t.prototype._put=function(e,t,r){var n="PUT",o=this._getOption("headers",n),i=this._getOption("options",n),a=this._getOption("url",n),s=a.dataType,c=this._buildApiUrl(this._resourceName,e,r,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:c,method:n,headers:o,options:i,data:this._convertRequestData(t,s)})},t.prototype._convertRequestData=function(e,t){return JSON.stringify(e)},t.prototype._convertResponseData=function(e,t){return JSON.parse(e)},t.prototype._getOption=function(e,t){var r=this._options.get("ajaxOptions",{}),n=e in r&&"COMMON"in r[e]?r[e].COMMON:{},o=e in r&&t in r[e]?r[e][t]:{};return Object.assign(n,o)},t.prototype._buildApiUrl=function(e,t,r,n){var o=n.baseUrl||this._component.settings.get("system.apiBaseUrl",""),i=n.scheme||"",a=n.host||"",s=n.dataType||"",c=n.version||"";return(n.format||"").replace("@scheme@",i).replace("@host@",a).replace("@baseUrl@",o).replace("@resource@",e).replace("@id@",t).replace("@dataType@",s).replace("@query@",this._buildUrlQuery(r)).replace("@version@",c)},t.prototype._buildUrlQuery=function(e){var t="";return e&&(t=Object.keys(e).reduce((function(t,r){return Array.isArray(e[r])?t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r].join())+"&":e[r]&&(t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])+"&"),t}),"")),t?"?"+t.slice(0,-1):""},t}(_),S=function(e){function t(t,r,n){e.call(this,t,r,Object.assign({autoLoad:!0},n)),this._name="ObjectResourceHandler",n.items&&(this.data=n.items)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._get=function(e,t){return this._data},t.prototype._put=function(e,t,r){this.data=t},t}(_),T=function(e){function t(t,r,n){e.call(this,t,r,Object.assign({autoLoad:!0},n)),this._name="LinkedResourceHandler",this._ref}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={target:{configurable:!0},data:{configurable:!0},items:{configurable:!0},item:{configurable:!0}};return r.target.get=function(){return this._ref.target},r.data.get=function(){return this._ref.data},r.data.set=function(e){this._ref.data=e},r.items.get=function(){return this._ref.items},r.item.get=function(){return this._ref.item},t.prototype._get=function(e,t){var r=this._options.items,n=r.rootNode,o=r.resourceName;r.state,this._ref=document.querySelector(n).resources[o]},t.prototype.getText=function(e){return this._ref.getText(e)},t.prototype.getItem=function(e){return this._ref.getItem(e)},Object.defineProperties(t.prototype,r),t}(_),I=function(e,t,r){this._name=t,this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},r)})},O={name:{configurable:!0},options:{configurable:!0}};O.name.get=function(){return this._name},O.name.set=function(e){this._name=e},O.options.get=function(){return this._options},I.createValidationResult=function(e,t,r,n,o){return{key:e,value:t,message:I._getFunctionValue(e,t,"message",r),fix:I._getFunctionValue(e,t,"fix",r),failed:n,extras:o}},I.validate=function(e,t,r){t=t||{};var n={};return(r=r||{}).allowList&&Object.keys(e).forEach((function(o){if(-1===r.allowList.indexOf(o)){n[o]=I.createValidationResult(o,e[o],t[o],[{rule:"allowList",validity:"notAllowed"}])}})),r.allowOnlyInRules&&Object.keys(e).forEach((function(r){if(!(r in t)){n[r]=I.createValidationResult(r,e[r],t[r],[{rule:"allowList",validity:"notAllowed"}])}})),r.disallowList&&Object.keys(e).forEach((function(o){if(r.disallowList.indexOf(o)>-1){n[o]=I.createValidationResult(o,e[o],t[o],[{rule:"disallowList",validity:"disallowed"}])}})),Object.keys(t).forEach((function(r){if("constraints"in t[r]&&t[r].constraints&&"required"in t[r].constraints&&t[r].constraints.required&&!(r in e)){n[r]=I.createValidationResult(r,e[r],t[r],[{rule:"required",validity:"valueMissing"}])}})),n},I.prototype.checkValidity=function(e,t,r){},I.prototype.reportValidity=function(e,t){},I._getFunctionValue=function(e,t,r,n){var o;return n&&r in n&&(o="function"==typeof n[r]?n[r](e,t,n):n[r]),o},Object.defineProperties(I.prototype,O);var M=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.validate=function(n,o){var i={};return BITSMIST.v1.Util.assert(n,"FormValidationHandler.checkValidity(): Form tag does not exist.",TypeError),BITSMIST.v1.Util.assert(n.checkValidity,"FormValidationHandler.checkValidity(): check validity not supported.",TypeError),BITSMIST.v1.Util.scopedSelectorAll(n,"input:not([novalidate])").forEach((function(n){var a=n.getAttribute("bm-bind"),s=r.getValue(n),c=o&&o[a]?o[a]:null,u=t._validateValue(n,a,s,c);u.length>0&&(i[a]=e.createValidationResult(a,s,c,u,{element:n}),i.message=i.message||n.validationMessage)})),i},t.prototype.checkValidity=function(n,o,i){var a,s={},c=this._component.querySelector("form");if(o||i){var u=r.getFields(c);s=e.validate(u,o,i)}a=t.validate(c,o);var l=BITSMIST.v1.Util.deepMerge(s,a);this._component.validationResult.result=!(Object.keys(l).length>0),this._component.validationResult.invalids=l},t.prototype.reportValidity=function(e,t){var r=this._component.querySelector("form");BITSMIST.v1.Util.assert(r,"FormValidationHandler.reportValidity(): Form tag does not exist.",TypeError),BITSMIST.v1.Util.assert(r.reportValidity,"FormValidationHandler.reportValidity(): Report validity not supported.",TypeError),r.reportValidity()},t._validateValue=function(e,t,r,n){var o=[],i=e.validity;if(!i.valid)for(var a in i)"valid"!==a&&i[a]&&o.push({validity:a});return o},t}(I),w=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.validate=function(r,n){var o={};return n&&Object.keys(r).forEach((function(i){if(n[i]){var a=t._validateValue(i,r[i],n[i]);a.length>0&&(o[i]=e.createValidationResult(i,r[i],n[i],a))}})),o},t.prototype.checkValidity=function(r,n,o){var i=e.validate(r,n,o),a=t.validate(r,n),s=BITSMIST.v1.Util.deepMerge(i,a);this._component.validationResult.result=!(Object.keys(s).length>0),this._component.validationResult.invalids=s},t.prototype.reportValidity=function(e,t){},t._validateValue=function(e,r,n){var o=[];return n&&n.constraints&&Object.keys(n.constraints).forEach((function(i){var a=t._checkConstraint(e,r,i,n.constraints[i]);a&&o.push(a)})),o},t._checkConstraint=function(e,r,n,o){var i;switch(n){case"type":i=t._checkType(e,r,n,o);break;case"required":r||(i={rule:"required",validity:"valueMissing"});break;case"minlength":String(r).length<o&&(i={rule:"minlength",validity:"tooShort(min:"+o+")"});break;case"maxlength":String(r).length>o&&(i={rule:"maxlength",validity:"tooLong(max:"+o+")"});break;case"min":parseInt(r)<o&&(i={rule:"min",validity:"rangeUnderflow(min:"+o+")"});break;case"max":parseInt(r)>o&&(i={rule:"max",validity:"rangeOverflow(max:"+o+")"});break;case"pattern":new RegExp(o).test(r)||(i={rule:"pattern",validity:"patternMismatch(pattern:"+o+")"});break;case"valids":-1===o.indexOf(r)&&(i={rule:"valids",validity:"validsMismatch"});break;case"custom":o(e,r,o)||(i={rule:"custom",validity:"customMismatch"})}return i},t._checkType=function(e,t,r,n){var o;if(t)switch(n){case"object":"object"!=typeof t&&(o={rule:"type",validity:"typeMismatch(object)"});break;case"function":"function"!=typeof t&&(o={rule:"type",validity:"typeMismatch(function)"});break;case"string":"string"!=typeof t&&(o={rule:"type",validity:"typeMismatch(string)"});break;case"number":var i=parseInt(t);isNaN(i)&&(o={rule:"type",validity:"typeMismatch(number)"})}return o},t}(I);function E(e){return Reflect.construct(BITSMIST.v1.Component,[e],this.constructor)}function B(){return Reflect.construct(BITSMIST.v1.Component,[],this.constructor)}function k(){return Reflect.construct(HTMLElement,[],this.constructor)}function j(){return Reflect.construct(HTMLElement,[],this.constructor)}function R(e){return Reflect.construct(BITSMIST.v1.Component,[e],this.constructor)}BITSMIST.v1.ClassUtil.inherit(E,BITSMIST.v1.Component),Object.defineProperty(E.prototype,"item",{get:function(){return this._item},set:function(e){this._item=e}}),Object.defineProperty(E.prototype,"cancelSubmit",{get:function(){return this._cancelSubmit},set:function(e){this._cancelSubmit=e}}),E.prototype.start=function(e){return this._item={},this._cancelSubmit=!1,e=Object.assign({},e,{settings:{autoClear:!0},organizers:{ValidationOrganizer:{settings:{attach:!0}}}}),BITSMIST.v1.Component.prototype.start.call(this,e)},E.prototype.switchTemplate=function(e,t){var n=this;return BITSMIST.v1.Component.prototype.switchTemplate.call(this,e,t).then((function(){r.hideConditionalElements(n)}))},E.prototype.build=function(e,t,n){r.build(e,t,n)},E.prototype.clear=function(e){return r.clearFields(this,e)},E.prototype.fill=function(e){var t=this,n="rootNode"in(e=Object.assign({},e))?this.querySelector(e.rootNode):this;BITSMIST.v1.Util.safeGet(e,"autoClear",this.settings.get("settings.autoClear"))&&this.clear();var o="item"in e?e.item:this._item;return Promise.resolve().then((function(){return r.showConditionalElements(t,o),t.trigger("beforeFill",e)})).then((function(){return r.setFields(n,o,{masters:t.resources,triggerEvent:"change"}),t.trigger("afterFill",e)}))},E.prototype.validate=function(e){var t=this;return e=Object.assign({},e),this.validationResult.result=!0,Promise.resolve().then((function(){return t.trigger("beforeValidate")})).then((function(){return t.callOrganizers("doCheckValidity",{item:t._item,validationName:t.settings.get("settings.validationName")})})).then((function(){return t.trigger("doValidate")})).then((function(){return t.trigger("afterValidate")})).then((function(){if(!t.validationResult.result)return t._cancelSubmit=!0,Promise.resolve().then((function(){return t.callOrganizers("doReportValidity",{validationName:t.settings.get("settings.validationName")})})).then((function(){return t.trigger("doReportValidatidy")}))}))},E.prototype.submit=function(e){var t=this;return e=Object.assign({},e),this._cancelSubmit=!1,this._item=r.getFields(this),Promise.resolve().then((function(){return t.validate(e)})).then((function(){if(!t._cancelSubmit)return Promise.resolve().then((function(){return t.trigger("beforeSubmit",{item:t._item})})).then((function(){return t.callOrganizers("doSubmit",e)})).then((function(){return t.trigger("doSubmit",{item:t._item})})).then((function(){return t.trigger("afterSubmit",{item:t._item})}))}))},BITSMIST.v1.ClassUtil.inherit(B,BITSMIST.v1.Component),Object.defineProperty(B.prototype,"rows",{get:function(){return this._rows}}),Object.defineProperty(B.prototype,"items",{get:function(){return this._items},set:function(e){this._items=e}}),B.prototype.start=function(e){return this._items=[],this._activeRowTemplateName="",this._listRootNode,this._rows,e=Object.assign({},e,{settings:{autoClear:!0}}),BITSMIST.v1.Component.prototype.start.call(this,e)},B.prototype.switchTemplate=function(e,t){var n=this;return BITSMIST.v1.Component.prototype.switchTemplate.call(this,e,t).then((function(){return r.hideConditionalElements(n),n.switchRowTemplate(n.settings.get("settings.rowTemplateName"))}))},B.prototype.switchRowTemplate=function(e,t){var r=this;return t=Object.assign({},t),this._activeRowTemplateName===e?Promise.resolve():Promise.resolve().then((function(){return r.addTemplate(e)})).then((function(){r._activeRowTemplateName=e})).then((function(){return r.callOrganizers("afterRowAppend",r.settings.items)})).then((function(){return r.trigger("afterRowAppend",t)})).then((function(){}))},B.prototype.clear=function(){this._listRootNode.innerHTML=""},B.prototype.fill=function(e){var t=this;e=Object.assign({},e);var n=this._getBuilder(e),o=document.createDocumentFragment();return this._rows=[],this._listRootNode=this.querySelector(this.settings.get("settings.listRootNode")),BITSMIST.v1.Util.assert(this._listRootNode,"List.fill(): List root node not found. name="+this.name+", listRootNode="+this.settings.get("settings.listRootNode")),Promise.resolve().then((function(){return r.showConditionalElements(t,t.item),t.trigger("beforeFill",e)})).then((function(){return n.call(t,o,t._items)})).then((function(){BITSMIST.v1.Util.safeGet(e,"autoClear",t.settings.get("settings.autoClear"))&&t.clear()})).then((function(){t._listRootNode.appendChild(o)})).then((function(){return t.trigger("afterFill",e)})).then((function(){}))},B.prototype._getBuilder=function(e){return BITSMIST.v1.Util.safeGet(e,"async",this.settings.get("settings.async",!0))?this._buildAsync:this._buildSync},B.prototype._buildSync=function(e,t){var r=this;BITSMIST.v1.Util.assert(this._templates[this._activeRowTemplateName],"List._buildSync(): Row template not loaded yet. name="+this.name+", rowTemplateName="+this._activeRowTemplateName);for(var n=Promise.resolve(),o=this.settings.get("rowevents"),i=this.templates[this._activeRowTemplateName].html,a=function(a){n=n.then((function(){return r._appendRowSync(e,a,t[a],i,o)}))},s=0;s<t.length;s++)a(s);return n},B.prototype._buildAsync=function(e,t){BITSMIST.v1.Util.assert(this.templates[this._activeRowTemplateName],"List._buildAsync(): Row template not loaded yet. name="+this.name+", rowTemplateName="+this._activeRowTemplateName);for(var r=this.settings.get("rowevents"),n=this.templates[this._activeRowTemplateName].html,o=0;o<t.length;o++)this._appendRowAsync(e,o,t[o],n,r)},B.prototype._createRow=function(e){var t=document.createElement("div");t.innerHTML=e;var r=t.firstElementChild;return r.setAttribute("bm-powered",""),r},B.prototype._appendRowSync=function(e,t,n,o,i){var a=this;this.triggerAsync("beforeBuildRow",{item:n});var s=Promise.resolve();s=s.then((function(){var s=a._createRow(o);return e.appendChild(s),a._rows.push(s),i&&Object.keys(i).forEach((function(e){a.initEvents(e,i[e],s)})),Promise.resolve().then((function(){return a.trigger("beforeFillRow",{item:n,no:t,element:s})})).then((function(){r.showConditionalElements(s,n),r.setFields(s,n,{masters:a.resources})})).then((function(){return a.trigger("afterFillRow",{item:n,no:t,element:s})}))}))},B.prototype._appendRowAsync=function(e,t,n,o,i){var a=this;this.triggerAsync("beforeBuildRow",{item:n});var s=this._createRow(o);e.appendChild(s),this._rows.push(s),i&&Object.keys(i).forEach((function(e){a.initEvents(e,i[e],s)})),this.triggerAsync("beforeFillRow",{item:n,no:t,element:s}),r.showConditionalElements(s,n),r.setFields(s,n,{masters:this.resources}),this.triggerAsync("afterFillRow",{item:n,no:t,element:s})},BITSMIST.v1.ClassUtil.inherit(k,BITSMIST.v1.Component),k.prototype.start=function(e){var t=this,r={settings:{name:"TagLoader"}};return e=e?BITSMIST.v1.Util.deepMerge(r,e):r,BITSMIST.v1.Component.prototype.start.call(this,e).then((function(){"loading"!==document.readyState?BITSMIST.v1.LoaderOrganizer.load(document.body,t.settings):document.addEventListener("DOMContentLoaded",(function(){BITSMIST.v1.LoaderOrganizer.load(document.body,t.settings)}))}))},customElements.define("bm-tagloader",k),BITSMIST.v1.ClassUtil.inherit(j,BITSMIST.v1.Component),j.prototype._getSettings=function(){return{settings:{name:"SettingManager",autoSetup:!1}}},customElements.define("bm-setting",j),BITSMIST.v1.ClassUtil.inherit(R,BITSMIST.v1.Component),R.prototype._getSettings=function(){return{settings:{autoRefresh:!1,autoSetup:!1,hasTemplate:!1,name:"PreferenceManager"},organizers:{ValidationOrganizer:{settings:{attach:!0}}}}},Object.defineProperty(R.prototype,"items",{get:function(){return h._store.items}}),R.prototype.get=function(e,t){return h._store.get(e,t)},R.prototype.set=function(e,t){var r=this;this._validationResult.result=!0,Promise.resolve().then((function(){return r.callOrganizers("doCheckValidity",{item:e,validationName:r._settings.get("settings.validationName")})})).then((function(){return r.trigger("doValidate")})).then((function(){if(!r._validationResult.result)throw new Error("PreferenceManager.set(): Validation failed. values="+JSON.stringify(e)+", invalids="+JSON.stringify(r._validationResult.invalids));if(h._store.set("",e,t),BITSMIST.v1.Util.safeGet(t,"autoSave",r.settings.get("preferences.settings.autoSave")))return r.resources.preferences.put("",h._store.localItems)}))},customElements.define("bm-preference",R),window.BITSMIST=window.BITSMIST||{},window.BITSMIST.v1=window.BITSMIST.v1||{},window.BITSMIST.v1.ObservableStore=e,window.BITSMIST.v1.BindableStore=n,BITSMIST.v1.OrganizerOrganizer.register("FileOrganizer",{object:o,targetWords:"files",targetEvents:["beforeStart","afterSpecLoad"],order:110}),BITSMIST.v1.OrganizerOrganizer.register("ErrorOrganizer",{object:i,targetWords:"errors",targetEvents:["beforeStart","afterSpecLoad"],order:120}),BITSMIST.v1.OrganizerOrganizer.register("ElementOrganizer",{object:a,targetWords:"elements",targetEvents:["beforeStart"],order:220}),BITSMIST.v1.OrganizerOrganizer.register("ResourceOrganizer",{object:s,targetWords:"resources",targetEvents:["beforeStart","afterSpecLoad","doFetch","doSubmit"],order:300}),BITSMIST.v1.OrganizerOrganizer.register("ValidationOrganizer",{object:c,targetWords:"validations",targetEvents:["beforeStart","afterSpecLoad","doCheckValidity","doReportValidity"],order:310}),BITSMIST.v1.OrganizerOrganizer.register("DatabindingOrganizer",{object:u,targetWords:"data",targetEvents:["afterAppend"],order:320}),BITSMIST.v1.OrganizerOrganizer.register("PluginOrganizer",{object:l,targetWords:"plugins",targetEvents:["beforeStart","afterSpecLoad"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("KeyOrganizer",{object:p,targetWords:"keys",targetEvents:["afterAppend"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("ChainOrganizer",{object:f,targetWords:"chains",targetEvents:["beforeStart","afterSpecLoad"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("DialogOrganizer",{object:d,targetWords:"dialog",targetEvents:["beforeStart","afterStart"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("PreferenceOrganizer",{object:h,targetWords:"preferences",targetEvents:["beforeStart","afterSpecLoad"],order:900}),window.BITSMIST.v1.Plugin=g,window.BITSMIST.v1.CookieResourceHandler=y,window.BITSMIST.v1.ApiResourceHandler=b,window.BITSMIST.v1.ObjectResourceHandler=S,window.BITSMIST.v1.LinkedResourceHandler=T,window.BITSMIST.v1.ValidationHandler=I,window.BITSMIST.v1.HTML5FormValidationHandler=M,window.BITSMIST.v1.ObjectValidationHandler=w,window.BITSMIST.v1.FormatterUtil=t,window.BITSMIST.v1.Form=E,window.BITSMIST.v1.List=B}();

!function(){"use strict";function r(t,e){this._name=t,this._options=e,this._data,this._parameters={}}var t=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),((i.prototype=Object.create(t&&t.prototype)).constructor=i).globalInit=function(){i.__initErrorListeners(),i._observers=new BITSMIST.v1.ObserverStore({filter:i.__filter})},i.organize=function(t,e,r){return e.settings.get("errors")&&i._observers.set(e.uniqueId,{object:e,targets:"*"}),r},i.__filter=function(t,e,r,n){for(var o=!1,i=e.object._settings.get("errors").targets,s=0;s<i.length;s++)if(n.error.name==i[s]){o=!0;break}return o},i.__initErrorListeners=function(){window.addEventListener("unhandledrejection",function(t){var e={};return t.reason?(t.reason instanceof XMLHttpRequest?(e.message=t.reason.statusText,e.stack=t.reason.stack):e.message=t.reason.message,e.object=t.reason):e.message=t,e.type=t.type,e.name=i.__getErrorName(t),e.filename="",e.funcname="",e.lineno="",e.colno="",i.__handleException(e),!1}),window.addEventListener("error",function(t,e,r,n){var o={type:"error"};return o.name=i.__getErrorName(t),o.message=t.message,o.file=t.filename,o.line=t.lineno,o.col=t.colno,t.error&&(o.stack=t.error.stack,o.object=t.error),i.__handleException(o),!1})},i.__getErrorName=function(t){var e,r,n=t.reason instanceof XMLHttpRequest||t.reason?t.reason:t.error?t.error:t.message;return n.name?e=n.name:n instanceof TypeError?e="TypeError":n instanceof XMLHttpRequest?e="AjaxError":n instanceof EvalError?e="EvalError":n instanceof RangeError?e="RangeError":n instanceof ReferenceError?e="ReferenceError":n instanceof SyntaxError?e="SyntaxError":n instanceof URIError?e="URIError":-1<(r=n.indexOf(":"))&&(e=n.substring(0,r)),e},i.__handleException=function(t){return i._observers.notifySync("trigger","error",i,{error:t})},i}(BITSMIST.v1.Organizer),e=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),((o.prototype=Object.create(t&&t.prototype)).constructor=o).init=function(t,e){e._plugins={}},o.organize=function(t,e,r){var n=e.settings.get("plugins");return n&&Object.keys(n).forEach(function(t){o._addPlugin(e,t,n[t])}),r},o._addPlugin=function(t,e,r){var n="className"in(r=Object.assign({},r))?r.className:e,o=BITSMIST.v1.ClassUtil.createObject(n,t,r);return t._plugins[e]=o},o}(BITSMIST.v1.Organizer),n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).organize=function(t,e,r){var n=[],o=r.files;return o&&Object.keys(o).forEach(function(t){n.push(BITSMIST.v1.AjaxUtil.loadScript(o[t].href))}),Promise.all(n).then(function(){return r})},e}(BITSMIST.v1.Organizer);r.prototype.get=function(t,e){var r=this,n="GET",o=this._getOption("headers",n),i=this._getOption("options",n),s=this._getOption("url",n),a=s.dataType,c=this._buildApiUrl(this._name,t,e,s);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:c,method:n,headers:o,options:i}).then(function(t){return r._convertResponseData(t.responseText,a)})},r.prototype.delete=function(t,e){var r=this,n="DELETE",o=this._getOption("headers",n),i=this._getOption("options",n),s=this._getOption("url",n),a=s.dataType,c=this._buildApiUrl(this._name,t,e,s);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:c,method:n,headers:o,options:i}).then(function(t){return r._convertResponseData(t.responseText,a)})},r.prototype.insert=function(t,e,r){var n=this,o="POST",i=this._getOption("headers",o),s=this._getOption("options",o),a=this._getOption("url",o),c=a.dataType,u=this._buildApiUrl(this._name,t,r,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:u,method:o,headers:i,options:s,data:this._convertRequestData(e,c)}).then(function(t){return n._convertResponseData(t.responseText,c)})},r.prototype.update=function(t,e,r){var n=this,o="PUT",i=this._getOption("headers",o),s=this._getOption("options",o),a=this._getOption("url",o),c=a.dataType,u=this._buildApiUrl(this._name,t,r,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:u,method:o,headers:i,options:s,data:this._convertRequestData(e,c)}).then(function(t){return n._convertResponseData(t.responseText,c)})},r.prototype._convertRequestData=function(t,e){var r;switch(e){case"json":default:r=JSON.stringify(t)}return r},r.prototype._convertResponseData=function(t,e){var r;switch(e){case"json":default:r=JSON.parse(t)}return r},r.prototype._getOption=function(t,e){var r="settings"in this._options?this._options.settings:{},n=t in r&&"COMMON"in r[t]?r[t].COMMON:{},o=t in r&&e in r[t]?r[t][e]:{};return Object.assign(n,o)},r.prototype._buildApiUrl=function(t,e,r,n){var o=n.baseUrl,i=n.scheme,s=n.host,a=n.dataType,c=n.version;return(n.format?n.format:"@baseUrl@@query@").replace("@scheme@",i).replace("@host@",s).replace("@baseUrl@",o).replace("@resource@",t).replace("@id@",e).replace("@dataType@",a).replace("@query@",this._buildUrlQuery(r)).replace("@version@",c)},r.prototype._buildUrlQuery=function(r){var t="";return r&&(t=Object.keys(r).reduce(function(t,e){return Array.isArray(r[e])?t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e].join())+"&":r[e]&&(t+=encodeURIComponent(e)+"="+encodeURIComponent(r[e])+"&"),t},"")),t?"?"+t.slice(0,-1):""};var i=function(o){function t(t,e){var r,n;o.call(this,t,e),this._items,"items"in e&&(n="object"==typeof e.items?e.items:(r=window,e.items.split(".").forEach(function(t){if(!(r=r[t]))throw new ReferenceError("Master not found. Master="+e.items)}),r),this._items=this.__reshapeItems(n))}o&&(t.__proto__=o),(t.prototype=Object.create(o&&o.prototype)).constructor=t;var e={items:{configurable:!0}};return e.items.get=function(){return this._items},t.prototype.load=function(){var e=this;return this.get("list").then(function(t){e._items=e.__reshapeItems(t.data)})},t.prototype.getValue=function(t){var e=t,r=this._options.title;return this._items&&t in this._items&&(e=this._items[t][r]),e},t.prototype.getItem=function(t){var e;return this._items&&t in this._items&&(e=this._items[t]),e},t.prototype.filter=function(r){var n=this;return Object.keys(this._items).reduce(function(t,e){return r(n._items[e])&&(t[e]=n._items[e]),t},{})},t.prototype.__reshapeItems=function(t){var n=this._options.id,o=this._options.title;return t.reduce(function(t,e){var r=e[n];return t[r]=e,t[r].title=e[o],t},{})},Object.defineProperties(t.prototype,e),t}(r),o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).init=function(t,e){Object.defineProperty(e,"masters",{get:function(){return this._masters}}),e._masters={}},e.organize=function(t,e,r){var n,o=this,i=[],s=r.masters;return s&&((n=e.settings.get("ajaxUtil",{})).url.COMMON.baseUrl=e.settings.get("system.apiBaseUrl",""),Object.keys(s).forEach(function(t){i.push(o._initMaster(e,t,s[t],n))})),Promise.all(i).then(function(){return r})},e._initMaster=function(t,e,r,n){if(t._masters[e]=new i(e,Object.assign({settings:n},r)),r.autoLoad)return t._masters[e].load()},e}(BITSMIST.v1.Organizer),s=function(t){function o(){t.apply(this,arguments)}return t&&(o.__proto__=t),((o.prototype=Object.create(t&&t.prototype)).constructor=o).globalInit=function(){o.__preferences=new BITSMIST.v1.Store,o.__observers=new BITSMIST.v1.ObserverStore({filter:o.__filter}),(o.__loaded={}).promise=new Promise(function(t,e){o.__loaded.resolve=t,o.__loaded.reject=e})},o.init=function(t,e){Object.defineProperty(e,"preferences",{get:function(){return this._preferences}}),e._preferences=new a(e),o._register(e)},o.organize=function(t,e,r){var n=Promise.resolve();return e.settings.items.preferences.load&&(o.__preferences.items=e.settings.get("preferences.defaults"),n=o._load(e).then(function(t){o.__preferences.merge(t),o.__loaded.resolve()})),n.then(function(){return o.__loaded.promise.then(function(){r.newPreferences=o.__preferences.items}).then(function(){return r})})},o._setup=function(t,e){(e=Object.assign({},e)).sender&&e.sender;return o.__observers.notify("setup",e).then(function(){e.newPreferences&&(o.__preferences.merge(e.newPreferences),o._save(t))})},o._register=function(t,e){o.__observers.set(t.uniqueId,{object:t,targets:e})},o._deregister=function(t){o.__observers.remove(t.uniqueId)},o._load=function(t,e){var r=e&&e.sender?e.sender:t;return t.trigger("doLoadStore",r)},o._save=function(t,e){var r=e&&e.sender?e.sender:t;return t.trigger("doSaveStore",r,{data:o.__preferences.items})},o.__filter=function(){return!0},o}(BITSMIST.v1.Organizer),a=function(t){this._component=t},c={items:{configurable:!0}};c.items.get=function(){return s.__preferences.items},a.prototype.set=function(t,e){return s.__preferences.set(t,e)},a.prototype.get=function(t){return s.__preferences.get(t)},a.prototype.load=function(){return s._load(this._component)},a.prototype.save=function(){return s._save(this._component)},a.prototype.setup=function(t){return s._setup(this._component,t)},Object.defineProperties(a.prototype,c);function u(e,t){var r=this;this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},this._getOptions(),t)}),this._options.set("name",this._options.get("name",this.constructor.name));var n,o=this._options.get("events",{});Object.keys(o).forEach(function(t){e.addEventHandler(e,t,o[t],null,r)}),this._options.get("expose")&&(n=this,Object.defineProperty(e.__proto__,this._options.get("expose"),{get:function(){return n}}))}var p={name:{configurable:!0},component:{configurable:!0}};function l(t){this._options=t||{}}p.name.get=function(){return this._options.get("name")},p.component.get=function(){return this._component},p.component.set=function(t){this._component=t},u.prototype._getOptions=function(){return{}},Object.defineProperties(u.prototype,p),l.prototype.get=function(t){var e=document.cookie.split(";").reduce(function(t,e){var r=e.split("="),n=r[0],o=r[1];return n&&(t[n.trim()]=o?decodeURIComponent(o.trim()):void 0),t},{});return e[t]?JSON.parse(e[t]):{}},l.prototype.set=function(t,e,r){var n=t+"="+encodeURIComponent(JSON.stringify(e))+"; ";r=r||{},this._options&&(r=Object.assign(this._options,r)),n+=Object.keys(r).reduce(function(t,e){return t+=e+"="+r[e]+"; "},""),document.cookie=n};var f=function(r){function t(t,e){r.call(this,t,e),this._cookie=new l(this._options.get("cookieOptions")),this._cookieName=this._options.get("cookieOptions.name","preferences")}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype.onDoLoadStore=function(){return this._cookie.get(this._cookieName)},t.prototype.onDoSaveStore=function(t,e){this._cookie.set(this._cookieName,e.detail.data)},t.prototype._getOptions=function(){return{events:{doLoadStore:this.onDoLoadStore,doSaveStore:this.onDoSaveStore}}},t}(u),h=function(r){function t(t,e){r.call(this,t,e),this._masters={}}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype.onAfterStart=function(){return this.__initMasters(this._component.settings.get("masters"))},t.prototype.onAfterSpecLoad=function(t,e){return this.__initMasters(BITSMIST.v1.Util.safeGet(e.detail,"spec.masters"))},t.prototype.__initMasters=function(e){var r,n=this,o=[];return e&&((r=this._component.settings.get("ajaxUtil",{})).url.COMMON.baseUrl=this._component.settings.get("system.apiBaseUrl",""),Object.keys(e).forEach(function(t){n._masters[t]=new i(t,Object.assign({settings:r},e[t])),e[t].autoLoad?o.push(n._masters[t].load().then(function(){n[t]=n._masters[t]})):n[t]=n._masters[t]})),Promise.all(o)},t.prototype._getOptions=function(){return{events:{afterStart:this.onAfterStart,afterSpecLoad:this.onAfterSpecLoad}}},t}(u),d=function(o){function t(t,e){var r=this;o.call(this,t,e),this._options.set("settings",this._component.settings.get("ajaxUtil","")),this._options.set("settings.url.COMMON.baseUrl",this._component.settings.get("system.apiBaseUrl","")),this._resources={},this._defaultResourceName;var n=this._options.get("resources",[]);Object.keys(n).forEach(function(t){var e=n[t];r.addResource(e,{settings:r._options.get("settings",{})})}),this.switchResource(n[0])}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.addResource=function(t,e){this._resources[t]=new r(t,Object.assign({settings:e.settings})),this[t]=this._resources[t]},t.prototype.switchResource=function(t){this._defaultResourceName=t},t.prototype.onDoFetch=function(t,e){var r=this,n=BITSMIST.v1.Util.safeGet(e.detail.target,"id"),o=BITSMIST.v1.Util.safeGet(e.detail.target,"parameters");if(BITSMIST.v1.Util.safeGet(e.detail.options,"autoLoad",this._options.get("autoLoad")))return this._resources[this._defaultResourceName].get(n,o).then(function(t){r._component.data=t,"items"in r._component?r._component.items=r._options.get("itemsGetter",function(t){return t.data})(t):"item"in r._component&&(r._component.item=r._options.get("itemGetter",function(t){return t.data[0]})(t))})},t.prototype.onDoSubmit=function(t,e){var r=this,n=BITSMIST.v1.Util.safeGet(e.detail.target,"id"),o=(BITSMIST.v1.Util.safeGet(e.detail.target,"parameters"),BITSMIST.v1.Util.safeGet(e.detail,"items"));return Promise.resolve().then(function(){return n?r._resources[r._defaultResourceName].update(n,{items:o}):r._resources[r._defaultResourceName].insert(n,{items:o})})},t.prototype._getOptions=function(){return{events:{doFetch:this.onDoFetch,doSubmit:this.onDoSubmit}}},t}(u);function _(){}function g(){}function m(t){var e=Reflect.construct(BITSMIST.v1.Pad,[t],this.constructor);return e._id,e._parameters,e._item={},e.__cancelSubmit=!1,e._target={},e}function v(){return Reflect.construct(BITSMIST.v1.Pad,[],this.constructor)}_.format=function(t,e,r){var n=r;switch(e.toLowerCase()){case"yyyy/mm/dd":n=_.formatDate(e,n);break;case"price":n=_.formatPrice(e,n)}return n},_.formatPrice=function(t,e){return e?"¥"+String(parseInt(e)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):""},_.formatNumber=function(t){return t?String(parseInt(t)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):""},_.formatDate=function(t,e){var r="";return e&&8==e.length&&(r=e.substr(0,4)+"/"+e.substr(4,2)+"/"+e.substr(6,2)),r},_.deformat=function(t,e,r){var n=r;switch(e){case"yyyy/mm/dd":n=_.deformatDate(e,r);break;case"price":n=_.deformatPrice(e,r)}return n},_.deformatPrice=function(t,e){var r="";return e&&(r=e.replace(/,/g,"").replace(/\//g,"").replace(/\\/g,"").replace("¥","")),r},_.deformatDate=function(t,e){var r="";return e&&(r=e.replace(/,/g,"").replace(/\//g,"").replace(/\\/g,"")),r},_.getNow=function(t){t=t||"-";var e=new Date;return e.getFullYear()+t+("00"+(e.getMonth()+1)).slice(-2)+t+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2)},_.getToday=function(t){t=void 0===t?"-":t;var e=new Date;return e.getFullYear()+t+("00"+(e.getMonth()+1)).slice(-2)+t+("00"+e.getDate()).slice(-2)},_.sanitize=function(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):t},g.setFields=function(t,o,i){var s=this,e=t.querySelectorAll("[data-bm-field]");Array.prototype.concat([t],Array.prototype.slice.call(e,0)).forEach(function(t){var e,r,n=t.getAttribute("data-bm-field");n in o&&(t.hasAttribute("data-bm-master")?(e=t.getAttribute("data-bm-master"),r=s.getMasterValue(i,e,o[n]),s.setValue(t,r)):s.setValue(t,o[n]))})},g.getFields=function(t,e){var o=this,i={};e=e||"";var r=t.querySelectorAll(e+" [data-bm-formitem]");return(r=Array.prototype.slice.call(r,0)).forEach(function(t){var e,r=t.getAttribute("data-bm-field"),n=o.getValue(t);Array.isArray(i[r])?n&&i[r].push(n):i[r]?n&&((e=[]).push(i[r]),e.push(n),i[r]=e):i[r]=n}),i},g.clearFields=function(t,e){e=e||"";var r=t.querySelectorAll(e+" input");(r=Array.prototype.slice.call(r,0)).forEach(function(t){switch(t.type.toLowerCase()){case"search":case"text":case"number":t.value="";break;case"checkbox":case"radio":t.checked=!1}}),r=t.querySelectorAll(e+" select"),(r=Array.prototype.slice.call(r,0)).forEach(function(t){t.selectedIndex=-1})},g.buildFields=function(t,e,o){var r=t.querySelectorAll("[data-bm-field='"+e+"']");(r=Array.prototype.slice.call(r,0)).forEach(function(n){var t,e,r;"select"==n.tagName.toLowerCase()?(n.options.length=0,"emptyItem"in o&&(t="text"in o.emptyItem?o.emptyItem.text:"",e="value"in o.emptyItem?o.emptyItem.value:"",(r=document.createElement("option")).text=t,r.value=e,r.setAttribute("selected",""),n.appendChild(r)),Object.keys(o.items).forEach(function(t){var e=document.createElement("option");e.text=o.items[t].title,e.value=t,n.appendChild(e)})):Object.keys(o.items).forEach(function(t){var e=document.createElement("label"),r=document.createElement("input");r.type="radio",r.id=key,r.name=key,r.value=t,r.setAttribute("data-bm-field",key),r.setAttribute("data-bm-formitem",""),e.appendChild(r),e.appendChild(document.createTextNode(o.items[t].title)),n.appendChild(e)})})},g.getMasterValue=function(t,e,r){var n=r;return t&&e in t&&(n=t[e].getValue(r)),n},g.setValue=function(t,e){null!==e&&null!=e||(e=""),t.hasAttribute("data-bm-format")&&(e=_.format("",t.getAttribute("data-bm-format"),e));var r=_.sanitize(e),n=t.getAttribute("data-bm-target");if(n)for(var o=n.split(","),i=0;i<o.length;i++){var s=o[i].toLowerCase();switch(s){case"html":t.innerHTML=e;break;case"href":case"src":case"rel":"http"!=e.substring(0,4)&&"/"!=e.substring(0,1)||t.setAttribute(s,e);break;default:var a=(a=t.getAttribute(s))?a+" "+e:r;t.setAttribute(s,a)}}else if(t.hasAttribute("value"))"input"==t.tagName.toLowerCase()&&"checkbox"==t.type.toLowerCase()||"input"==t.tagName.toLowerCase()&&"radio"==t.type.toLowerCase()?Array.isArray(e)?-1<e.indexOf(t.getAttribute("value"))&&(t.checked=!0):t.getAttribute("value")==e&&(t.checked=!0):t.setAttribute("value",_.sanitize(e));else if("select"==t.tagName.toLowerCase())t.value=e;else if("fieldset"!=t.tagName.toLowerCase())if("input"==t.tagName.toLowerCase())switch(t.type.toLowerCase()){case"number":case"search":case"text":t.value=e;break;case"checkbox":t.checked=!!e;break;case"radio":t.value==e&&(t.checked=!0)}else t.innerText=e;var c=document.createEvent("HTMLEvents");c.initEvent("change",!0,!0),t.dispatchEvent(c)},g.getValue=function(t){var e=void 0;switch(t.tagName.toLowerCase()){case"input":switch(t.type.toLowerCase()){case"radio":case"checkbox":t.checked&&(e=t.hasAttribute("value")?t.getAttribute("value"):t.checked);break;default:e=t.value}break;case"select":e=t.value;break;default:t.hasAttribute("selected")&&(e=t.getAttribute("value"))}return t.hasAttribute("data-bm-format")&&(e=BITSMIST.v1.FormatterUtil.deformat("",t.getAttribute("data-bm-format"),e)),e},g.reportValidity=function(t){var e=!0,r=t.querySelectorAll("input");return(r=Array.prototype.slice.call(r,0)).forEach(function(t){switch(t.getAttribute("type")){case"number":(t.validity&&0==t.validity.valid||isNaN(t.value))&&(t.style.border="solid 3px red",e=!1)}}),e},BITSMIST.v1.ClassUtil.inherit(m,BITSMIST.v1.Pad),Object.defineProperty(m.prototype,"item",{get:function(){return this._item},set:function(t){this._item=t}}),Object.defineProperty(m.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t}}),m.prototype.build=function(e){var r=this;Object.keys(e).forEach(function(t){g.buildFields(r,t,e[t])})},m.prototype.fill=function(t){var e=this,r=(t=Object.assign({},t)).sender?t.sender:this;return this._target.id="id"in t?t.id:this._target.id,this._target.parameters="parameters"in t?t.parameters:this._target.parameters,BITSMIST.v1.Util.safeGet(t,"settings.autoClear",this._settings.get("settings.autoClear"))&&this.clear(),Promise.resolve().then(function(){return e.trigger("doTarget",r,{target:e._target,options:t})}).then(function(){return e.trigger("beforeFetch",r,{target:e._target,options:t})}).then(function(){return e.trigger("doFetch",r,{target:e._target,options:t})}).then(function(){return e.trigger("afterFetch",r,{target:e._target,options:t})}).then(function(){return e.trigger("beforeFill",r)}).then(function(){return g.setFields(e,e._item,e.masters),e.trigger("afterFill",r)})},m.prototype.clear=function(t){return g.clearFields(this,t)},m.prototype.validate=function(t){var r=this,n=(t=Object.assign({},t)).sender?t.sender:this;return Promise.resolve().then(function(){return r.trigger("beforeValidate",n)}).then(function(){var t=!0,e=r.querySelector("form");return r.settings.get("settings.autoValidate")&&(t=e&&e.reportValidity?e.reportValidity():g.reportValidity(r)),t||(r.__cancelSubmit=!0),r.trigger("afterValidate",n)})},m.prototype.submit=function(t){var e=this,r=(t=Object.assign({},t)).sender?t.sender:this;return delete t.sender,this.__cancelSubmit=!1,this._item=this.getFields(),Promise.resolve().then(function(){return e.validate()}).then(function(){return e.trigger("beforeSubmit",r)}).then(function(){if(!e.__cancelSubmit){var t=e.settings.get("settings.itemGetter",function(t){return[t]})(e._item);return e.trigger("doSubmit",r,{target:e._target,items:t})}}).then(function(){var t=e.settings.get("settings.itemGetter",function(t){return[t]})(e._item);return e.trigger("afterSubmit",r,{target:e._target,items:t})})},m.prototype.getFields=function(){return g.getFields(this)},BITSMIST.v1.ClassUtil.inherit(v,BITSMIST.v1.Pad),Object.defineProperty(v.prototype,"row",{get:function(){return this._row}}),Object.defineProperty(v.prototype,"items",{get:function(){return this._items},set:function(t){this._items=t}}),Object.defineProperty(v.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t}}),v.prototype.onListAfterAppend=function(t,e,r){this._listRootNode=this.querySelector(this._settings.get("settings.listRootNode"));var n=this._settings.get("components")[this._settings.get("settings.row")].className?this._settings.get("components")[this._settings.get("row")].className:this._settings.get("settings.row");return this._row=BITSMIST.v1.ClassUtil.createObject(n),(this._row._parent=this)._row.start()},v.prototype.clear=function(){this._listRootNode.innerHTML=""},v.prototype.fill=function(t){var e=this,r=(t=Object.assign({},t)).sender?t.sender:this,n=this._settings.get("settings.async")?this._buildAsync:this._buildSync,o=document.createDocumentFragment();return this._rows=[],this._target.id="id"in t?t.id:this._target.id,this._target.parameters="parameters"in t?t.parameters:this._target.parameters,Promise.resolve().then(function(){return e.trigger("doTarget",e,{target:e._target,options:t})}).then(function(){return e.trigger("beforeFetch",r,{target:e._target,options:t})}).then(function(){return e.trigger("doFetch",r,{target:e._target,options:t})}).then(function(){return e.trigger("afterFetch",r,{target:e._target,options:t})}).then(function(){return e.trigger("beforeFill",r)}).then(function(){if(e._items)return n.call(e,o)}).then(function(){BITSMIST.v1.Util.safeGet(t,"autoClear",e._settings.get("settings.autoClear"))&&e.clear()}).then(function(){e._listRootNode.appendChild(o)}).then(function(){return e.trigger("afterFill",r)})},v.prototype.start=function(t){return this._id,this._parameters,this._target={},this._data,this._items,this._listRootNode,this._row,this._rows,t=Object.assign({},t,{events:{afterAppend:[{handler:this.onListAfterAppend}]}}),BITSMIST.v1.Pad.prototype.start.call(this,t)},v.prototype._buildSync=function(t){for(var e=this._row.getEventHandler(this._row.settings.get("events.click")),r=this._row.settings.get("elements"),n=this._row._templates[this._row.settings.get("settings.templateName")].html,o=0;o<this._items.length;o++)this.__appendRowSync(t,o,this._items[o],n,e,r)},v.prototype._buildAsync=function(e){for(var r=this,n=Promise.resolve(),o=this._row.getEventHandler(this._row.settings.get("events.click")),i=this._row.settings.get("elements"),s=this._row._templates[this._row.settings.get("settings.templateName")].html,t=0;t<r._items.length;t++)!function(t){n=n.then(function(){return r.__appendRowAsync(e,t,r._items[t],s,o,i)})}(t);return n},v.prototype.__appendRowAsync=function(t,e,r,n,o,i){var s=this,a=document.createElement("div");a.innerHTML=n;var c=a.firstElementChild;return t.appendChild(c),this._rows.push(c),o&&this._row.addEventHandler(c,"click",o,{item:r,no:e,element:c}),i&&Object.keys(i).forEach(function(t){s._row.initElements(t,{item:r,no:e,element:c},c)}),Promise.resolve().then(function(){return s._row.trigger("beforeFillRow",s,{item:r,no:e,element:c})}).then(function(){g.setFields(c,r,s.masters)}).then(function(){return s._row.trigger("afterFillRow",s,{item:r,no:e,element:c})})},v.prototype.__appendRowSync=function(t,e,r,n,o,i){var s=this,a=document.createElement("div");a.innerHTML=n;var c=a.firstElementChild;t.appendChild(c),this._rows.push(c),o&&this._row.addEventHandler(c,"click",o,{item:r,no:e,element:c}),i&&Object.keys(i).forEach(function(t){s._row.initElements(t,{item:r,no:e,element:c},c)}),this._row.triggerSync("beforeFillRow",this,{item:r,no:e,element:c}),g.setFields(c,r,this.masters),this.row.triggerSync("afterFillRow",this,{item:r,no:e,element:c})};var y=function(r){function t(t,e){r.call(this,t,e),this.__isComposing=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype.onAfterAppend=function(){var t=this._options.get("features.defaultKeys");t&&(this._component.addEventHandler(this._component,"keydown",this.onKeyDown,t,this),this._component.addEventHandler(this._component,"keypress",this.onKeyPress,t,this),this._component.addEventHandler(this._component,"compositionstart",this.onCompositionStart,t,this),this._component.addEventHandler(this._component,"compositionend",this.onCompositionEnd,t,this));var e=this._options.get("features.defaultButtons");e&&(this.__initElements(e.submit,this.onDefaultSubmit),this.__initElements(e.cancel,this.onDefaultCancel),this.__initElements(e.clear,this.onDefaultClear))},t.prototype.onKeyDown=function(t,e,r){var n=e.key?e.key:this.__getKeyfromKeyCode(e.keyCode);switch(n="esc"==(n=n.toLowerCase())?"escape":n){case"escape":this.onKeyPress(t,e,r)}},t.prototype.onKeyPress=function(t,e,r){var n;this.__isComposing||229==e.keyCode||(n="esc"==(n=(n=e.key?e.key:this.__getKeyfromKeyCode(e.keyCode)).toLowerCase())?"escape":n,r.options.submit&&n==r.options.submit.key?this.onDefaultSubmit(t,e,{options:r.options.submit}):r.options.cancel&&n==r.options.cancel.key?this.onDefaultCancel(t,e,{options:r.options.cancel}):r.options.clear&&n==r.options.clear.key&&this.onDefaultClear(t,e,{options:r.options.clear}))},t.prototype.onCompositionStart=function(){this.__isComposing=!0},t.prototype.onCompositionEnd=function(){this.__isComposing=!1},t.prototype.onDefaultSubmit=function(t,e,r){var n=this;this._component.submit().then(function(){n._component.__cancelSubmit||(n._component._isModal&&(n._component._modalResult.result=!0),r&&r.options.autoClose&&n._component.close())})},t.prototype.onDefaultCancel=function(){this._component.close()},t.prototype.onDefaultClear=function(t,e,r){var n;r&&r.options.target&&(n=t.getAttribute(r.options.target)),this._component.clear(n)},t.prototype.__getKeyfromKeyCode=function(t){var e;switch(t){case 13:e="Enter";break;default:e=String.fromCharCode(t)}return e},t.prototype.__initElements=function(e,r){var t,n=this;e&&(t=this._component.querySelectorAll(e.rootNode),(t=Array.prototype.slice.call(t,0)).forEach(function(t){n._component.addEventHandler(t,"click",r,e,n)}))},t.prototype._getOptions=function(){return{events:{afterAppend:this.onAfterAppend}}},t}(u),b=function(r){function t(t,e){r.call(this,"authentications",e)}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype.authenticate=function(r,n,o){var i=this;return new Promise(function(t,e){i.get("list",{user:r,password:n}).then(function(t){0<t.result.resultCount?o&&"redirect"in o&&(location.href=decodeURI(o.redirect)):e("login failed")})})},t}(r);window.BITSMIST=window.BITSMIST||{},window.BITSMIST.v1=window.BITSMIST.v1||{},BITSMIST.v1.OrganizerOrganizer.organizers.set("ErrorOrganizer",{object:t,targetWords:"errors",targetEvents:["beforeStart"],order:100}),BITSMIST.v1.OrganizerOrganizer.organizers.set("PluginOrganizer",{object:e,targetWords:"plugins",targetEvents:["beforeStart"],order:400}),BITSMIST.v1.OrganizerOrganizer.organizers.set("FileOrganizer",{object:n,targetWords:"files",targetEvents:["afterSpecLoad"],order:400}),BITSMIST.v1.OrganizerOrganizer.organizers.set("MasterOrganizer",{object:o,targetWords:"masters",targetEvents:["beforeStart","afterSpecLoad"],order:400}),BITSMIST.v1.OrganizerOrganizer.organizers.set("PreferenceOrganizer",{object:s,targetWords:"preferences",targetEvents:["beforeStart"],order:500}),BITSMIST.v1.OrganizerOrganizer.organizers.get("ComponentOrganizer").targetEvents.push("afterSpecLoad"),BITSMIST.v1.OrganizerOrganizer.organizers.get("AttrOrganizer").targetEvents.push("afterSpecLoad"),BITSMIST.v1.OrganizerOrganizer.organizers.get("ElementOrganizer").targetEvents.push("afterSpecLoad"),window.BITSMIST.v1.Plugin=u,window.BITSMIST.v1.CookieStoreHandler=f,window.BITSMIST.v1.MasterHandler=h,window.BITSMIST.v1.ResourceHandler=d,window.BITSMIST.v1.Form=m,window.BITSMIST.v1.List=v,window.BITSMIST.v1.DefaultkeyHandler=y,window.BITSMIST.v1.AuthenticationUtil=b,window.BITSMIST.v1.FormatterUtil=_,window.BITSMIST.v1.MasterUtil=i,window.BITSMIST.v1.ResourceUtil=r}();

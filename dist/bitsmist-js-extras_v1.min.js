!function(){"use strict";class e extends BITSMIST.v1.ChainableStore{constructor(e){super(Object.assign({notifyOnChange:!0,async:!1},e)),this._filter,this._observers=[],this.filter=BITSMIST.v1.Util.safeGet(this._options,"filter",(()=>!0))}get filter(){return this._filter}set filter(e){BITSMIST.v1.Util.assert("function"==typeof e,`Store.filter(setter): Filter is not a function. filter=${e}`,TypeError),this._filter=e}set(e,t,r){let i={},s=e?this.get(e):this._items;if(s&&"object"==typeof s?this.__deepMerge(s,t,i):this.get(e)!==t&&(BITSMIST.v1.Util.safeSet(this._items,e,t),i[e]=t),BITSMIST.v1.Util.safeGet(r,"notifyOnChange",BITSMIST.v1.Util.safeGet(this._options,"notifyOnChange"))&&Object.keys(i).length>0)return this.notify(i)}replace(e,t){if(this._items={},this.__deepMerge(this._items,e),BITSMIST.v1.Util.safeGet(t,"notifyOnChange",BITSMIST.v1.Util.safeGet(this._options,"notifyOnChange")))return this.notify("*")}subscribe(e,t,r){BITSMIST.v1.Util.assert("function"==typeof t,`ObservableStore.subscribe(): Notification handler is not a function. id=${e}`,TypeError),this._observers.push({id:e,handler:t,options:r})}unsubscribe(e){for(let t=0;t<this._observers.length;t++)if(this._obvservers[t].id===e){this._observers.splice(t,1);break}}notify(e,...t){return BITSMIST.v1.Util.safeGet(this._options,"async",!1)?this.notifyAsync(e,...t):this.notifySync(e,...t)}notifySync(e,...t){let r=Promise.resolve();for(let i=0;i<this._observers.length;i++)r=r.then((()=>{if(this._filter(e,this._observers[i],...t))return this._observers[i].handler(e,...t)}));return r}notifyAsync(e,...t){for(let r=0;r<this._observers.length;r++)this._filter(e,this._observers[r].options,...t)&&this._observers[r].handler(e,...t);return Promise.resolve()}mute(){this._options.notifyOnChange=!1}unmute(){this._options.notifyOnChange=!0}__deepMerge(e,t,r){return r=r||{},BITSMIST.v1.Util.assert(e&&"object"==typeof e&&t&&"object"==typeof t,"ObservableStore.__deepMerge(): Parameters must be an object.",TypeError),Object.keys(t).forEach((i=>{Array.isArray(e[i])?(e[i]=e[i].concat(t[i]),r[i]=e[i]):e.hasOwnProperty(i)&&e[i]&&"object"==typeof e[i]&&t[i]&&"object"==typeof t[i]&&!(e[i]instanceof HTMLElement)?Util.deepMerge(e[i],t[i]):e[i]!==t[i]&&(e[i]=t[i],r[i]=e[i])})),e}}function t(){}function r(){}t.format=function(e,r,i){let s=i;switch(r.toLowerCase()){case"yyyy/mm/dd":s=t.formatDate(r,s);break;case"price":s=t.formatPrice(r,s)}return s},t.formatPrice=function(e,t){return t?"¥"+String(parseInt(t)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):""},t.formatNumber=function(e){return e?String(parseInt(e)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"):""},t.formatDate=function(e,t){var r="";return t&&8===t.length&&(r=t.substr(0,4)+"/"+t.substr(4,2)+"/"+t.substr(6,2)),r},t.deformat=function(e,r,i){let s=i;switch(r){case"yyyy/mm/dd":s=t.deformatDate(r,i);break;case"price":s=t.deformatPrice(r,i)}return s},t.deformatPrice=function(e,t){var r="";return t&&(r=t.replace(/,/g,"").replace(/\//g,"").replace(/\\/g,"").replace("¥","")),r},t.deformatDate=function(e,t){var r="";return t&&(r=t.replace(/,/g,"").replace(/\//g,"").replace(/\\/g,"")),r},t.getNow=function(e){e=e||"-";var t=new Date;return t.getFullYear()+e+("00"+(t.getMonth()+1)).slice(-2)+e+("00"+t.getDate()).slice(-2)+" "+("00"+t.getHours()).slice(-2)+":"+("00"+t.getMinutes()).slice(-2)+":"+("00"+t.getSeconds()).slice(-2)},t.getToday=function(e){e=void 0===e?"-":e;var t=new Date;return t.getFullYear()+e+("00"+(t.getMonth()+1)).slice(-2)+e+("00"+t.getDate()).slice(-2)},t.sanitize=function(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):e},r.showConditionalElements=function(e,t){BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-visible]").forEach((e=>{let r=e.getAttribute("bm-visible");BITSMIST.v1.Util.safeEval(r,t,t)?e.style.removeProperty("display"):e.style.display="none"}))},r.hideConditionalElements=function(e){BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-visible]").forEach((e=>{e.style.display="none"}))},r.setFields=function(e,i,s){let a=BITSMIST.v1.Util.safeGet(s,"masters"),n=BITSMIST.v1.Util.safeGet(s,"triggerEvent"),o=BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-bind]");o.push(e),o.forEach((e=>{let s=e.getAttribute("bm-bind");if(s in i){let o=BITSMIST.v1.Util.safeGet(i,s,"");if(e.hasAttribute("bm-bindtext")){let t=e.getAttribute("bm-bindtext").split("."),n=t[0],l=t[1]||"";o=r._getMasterValue(a,n,i[s],l)}if(e.hasAttribute("bm-format")&&(o=t.format("",e.getAttribute("bm-format"),o)),r.setValue(e,o),n){let t=document.createEvent("HTMLEvents");t.initEvent(n,!0,!0),e.dispatchEvent(t)}}}))},r.getFields=function(e){let t={},i=BITSMIST.v1.Util.scopedSelectorAll(e,"[bm-bind]");return i.push(e),i.forEach((e=>{let i=e.getAttribute("bm-bind"),s=r.getValue(e);if(e.hasAttribute("bm-format")&&(s=BITSMIST.v1.FormatterUtil.deformat("",e.getAttribute("bm-format"),s)),Array.isArray(t[i]))s&&t[i].push(s);else if(t[i]){if(s){let e=[];e.push(t[i]),e.push(s),t[i]=e}}else t[i]=s})),t},r.clearFields=function(e,t){t=t||"";let r=BITSMIST.v1.Util.scopedSelectorAll(e,t+" input");r.forEach((e=>{switch(e.type.toLowerCase()){case"search":case"text":case"number":e.value="";break;case"checkbox":case"radio":e.checked=!1}})),r=e.querySelectorAll(t+" select"),r=Array.prototype.slice.call(r,0),r.forEach((e=>{e.selectedIndex=-1}))},r.setValue=function(e,t){null==t&&(t="");let i=e.getAttribute("bm-bindtarget");i?r._setValue_target(e,i,t):e.hasAttribute("value")?r._setValue_value(e,t):r._setValue_element(e,t)},r.build=function(e,t,i){if("select"===e.tagName.toLowerCase())r._build_select(e,t,i)},r.getValue=function(e){let t;switch(e.tagName.toLowerCase()){case"input":switch(e.type.toLowerCase()){case"radio":case"checkbox":e.checked&&(t=e.hasAttribute("value")?e.getAttribute("value"):e.checked);break;default:t=e.value}break;case"select":t=e.value;break;default:e.hasAttribute("selected")&&(t=e.getAttribute("value"))}return t},r._build_select=function(e,t,r){if(r=r||{},e.options.length=0,"emptyItem"in r){let t="text"in r.emptyItem?r.emptyItem.text:"",i="value"in r.emptyItem?r.emptyItem.value:"",s=document.createElement("option");s.text=t,s.value=i,s.setAttribute("selected",""),e.appendChild(s)}Object.keys(t).forEach((i=>{let s=document.createElement("option");s.text=r.text?t[i][r.text]:i,s.value=r.value?t[i][r.value]:i,e.appendChild(s)})),"defaultValue"in r&&(e.value=r.defaultValue)},r._build_radio=function(e,t,r){Object.keys(r.items).forEach((e=>{let t=document.createElement("label"),i=document.createElement("input");i.type="radio",i.id=key,i.name=key,i.value=e,i.setAttribute("bm-bind",key),i.setAttribute("bm-submit",""),t.appendChild(i),t.appendChild(document.createTextNode(r.items[e].title)),element.appendChild(t)}))},r._setValue_target=function(e,t,r){let i=t.split(",");for(let t=0;t<i.length;t++){let s=i[t].toLowerCase();switch(s){case"text":e.innerText=r;break;case"html":e.innerHTML=r;break;case"outerhtml":r&&(e.outerHTML=r);break;case"href":case"src":case"rel":"http"!==r.substring(0,4)&&"/"!==r.substring(0,1)||e.setAttribute(s,r);break;default:let t=e.getAttribute(s);t=t?t+" "+r:r,e.setAttribute(s,t)}}},r._setValue_value=function(e,t){"input"===e.tagName.toLowerCase()&&"checkbox"===e.type.toLowerCase()||"input"===e.tagName.toLowerCase()&&"radio"===e.type.toLowerCase()?Array.isArray(t)?t.indexOf(e.getAttribute("value"))>-1&&(e.checked=!0):e.getAttribute("value")===t&&(e.checked=!0):e.setAttribute("value",t)},r._setValue_element=function(e,t){if("select"===e.tagName.toLowerCase())e.value=t;else if("input"===e.tagName.toLowerCase())switch(e.type.toLowerCase()){case"number":case"search":case"text":e.value=t;break;case"checkbox":e.checked=!!t;break;case"radio":e.value===t&&(e.checked=!0)}else e.innerText=t},r._getMasterValue=function(e,t,r,i){let s=r;if(e&&t in e){let a=e[t].getItem(r);a&&(s=a[i])}return s};class i extends e{constructor(e){super(e),this.filter=(e,t,...r)=>{let i=!1;return("*"===e||e.indexOf(t.id)>-1)&&(i=!0),i}}bindTo(e){let t=e.getAttribute("bm-bind");if(!!(!e.__bm_bindinfo||!e.__bm_bindinfo.bound)&&BITSMIST.v1.Util.safeGet(this._options,"2way",!0)){this.subscribe(t,(()=>{r.setValue(e,this.get(t))}));let i=BITSMIST.v1.Util.safeGet(this._options,"eventName","change");e.addEventListener(i,(()=>{this.set(t,r.getValue(e),{notifyOnChange:!1})}).bind(this)),e.__bm_bindinfo={bound:!0}}}}class s extends BITSMIST.v1.Organizer{static organize(e,t,r){let i=[],s=r.files;return s&&Object.keys(s).forEach((e=>{i.push(BITSMIST.v1.AjaxUtil.loadScript(s[e].href))})),Promise.all(i)}}class a extends BITSMIST.v1.Organizer{static globalInit(){a._observers=new BITSMIST.v1.ObservableStore({filter:a.__filter}),document.addEventListener("DOMContentLoaded",(()=>{BITSMIST.v1.settings.get("organizers.ErrorOrganizer.settings.captureError",!0)&&a.__initErrorListeners()}))}static organize(e,t,r){r.errors&&a._observers.subscribe(t.uniqueId,t.trigger.bind(t),{component:t})}static __filter(e,t,r){let i=!1,s=t.component.settings.get("errors.targets");for(let e=0;e<s.length;e++)if(r.error.name===s[e]||"*"===s[e]){i=!0;break}return i}static __initErrorListeners(){window.addEventListener("unhandledrejection",(e=>{let t={};return e.reason?e.reason instanceof XMLHttpRequest?(t.message=e.reason.statusText,t.stack=e.reason.stack,t.object=e.reason):(t.message=e.reason.message,t.object=e.reason):t.message=e,t.type=e.type,t.name=a.__getErrorName(e),t.filename="",t.funcname="",t.lineno="",t.colno="",a.__handleException(t),!1})),window.addEventListener("error",((e,t,r,i)=>{let s={type:"error"};return s.name=a.__getErrorName(e),s.message=e.message,s.file=e.filename,s.line=e.lineno,s.col=e.colno,e.error&&(s.stack=e.error.stack,s.object=e.error),a.__handleException(s),!1}))}static __getErrorName(e){let t,r;if(r=e.reason instanceof XMLHttpRequest||e.reason?e.reason:e.error?e.error:e.message,r.name)t=r.name;else if(r instanceof TypeError)t="TypeError";else if(r instanceof XMLHttpRequest)t="AjaxError";else if(r instanceof EvalError)t="EvalError";else if(r instanceof RangeError)t="RangeError";else if(r instanceof ReferenceError)t="ReferenceError";else if(r instanceof SyntaxError)t="SyntaxError";else if(r instanceof URIError)t="URIError";else{let e=r.indexOf(":");e>-1&&(t=r.substring(0,e))}return t}static __handleException(e){return a._observers.notifyAsync("error",{sender:a,error:e})}}class n extends BITSMIST.v1.Organizer{static organize(e,t,r){let i=r.elements;i&&Object.keys(i).forEach((e=>{t.addEventHandler(e,{handler:n.onDoOrganize,options:{attrs:i[e]}})}))}static onDoOrganize(e,t,r){let i=r.component,s=r.options.attrs;Object.keys(s).forEach((e=>{n.__initAttr(i,e,s[e])}))}static __getTargetElements(e,t,r){let i;return i=r.rootNode?"this"===r.rootNode||r.rootNode===e.tagName.toLowerCase()?[e]:e.querySelectorAll(r.rootNode):"this"===t||t===e.tagName.toLowerCase()?[e]:e.querySelectorAll("#"+t),i}static __initAttr(e,t,i){if(i){let s=n.__getTargetElements(e,t,i);for(let t=0;t<s.length;t++)Object.keys(i).forEach((a=>{switch(a){case"build":let n=i[a].resourceName;r.build(s[t],e.resources[n].items,i[a]);break;case"attribute":Object.keys(i[a]).forEach((e=>{s[t].setAttribute(e,i[a][e])}));break;case"style":Object.keys(i[a]).forEach((e=>{s[t].style[e]=i[a][e]}));break;case"property":Object.keys(i[a]).forEach((e=>{s[t][e]=i[a][e]}));break;case"autoFocus":s[t].focus()}}))}}}class o extends BITSMIST.v1.Organizer{static init(e,t){Object.defineProperty(e,"resources",{get(){return this._resources}}),e.addResource=function(e,t){return o._addResource(this,e,t)},e.switchResource=function(e){return o._switchResource(this,e)},e._resources={}}static organize(e,t,r){let i=[];switch(e){case"beforeStart":case"afterSpecLoad":let e=r.resources;e&&Object.keys(e).forEach((r=>{let s=BITSMIST.v1.Util.safeGet(e[r],"handlerOptions.resourceName",r),a=o._addResource(t,s,e[r]);if(a.options.get("autoLoad")){let e=a.options.get("autoLoadOptions.id"),s=a.options.get("autoLoadOptions.parameters");i.push(t._resources[r].get(e,s))}}));break;case"doFetch":i.push(o.doFetch(t,r));break;case"doSubmit":i.push(o.doSubmit(t,r))}return Promise.all(i)}static _addResource(e,t,r){let i;return r.handlerClassName&&(i=BITSMIST.v1.ClassUtil.createObject(r.handlerClassName,e,t,r.handlerOptions),e._resources[t]=i),i}static _switchResource(e){this._defaultResource=this._resources[e]}static doFetch(e,t){let r=[],i=o.__getTargetResources(e,t,"autoFetch");for(let s=0;s<i.length;s++){let a=i[s],n=BITSMIST.v1.Util.safeGet(t,"id",e._resources[a].target.id),o=BITSMIST.v1.Util.safeGet(t,"parameters",e._resources[a].target.parameters);e._resources[a].target.id=n,e._resources[a].target.parameters=o,r.push(e._resources[a].get(n,o))}return Promise.all(r).then((()=>{let t=e.settings.get("settings.resourceName");t&&e._resources[t]&&(e.items=e._resources[t].items,e.item=e._resources[t].item)}))}static doSubmit(e,t){let r=[],i={},s=o.__getTargetResources(e,t,"autoSubmit"),a=e.querySelectorAll("[bm-submit]");a=Array.prototype.slice.call(a,0),a.forEach((t=>{let r=t.getAttribute("bm-bind");i[r]=e.item[r]}));for(let a=0;a<s.length;a++){let n=s[a],o=BITSMIST.v1.Util.safeGet(t,"method",e._resources[n].target.method||"put"),l=BITSMIST.v1.Util.safeGet(t,"id",e._resources[n].target.id),c=BITSMIST.v1.Util.safeGet(t,"parameters",e._resources[n].target.parameters);r.push(e._resources[n][o](l,i,c))}return Promise.all(r)}static __getTargetResources(e,t,r){let i=BITSMIST.v1.Util.safeGet(t,r,e.settings.get("settings."+r,[]));return Array.isArray(i)||("string"==typeof i?i=[e.settings.get("settings."+r)]:!0===i&&e.settings.get("settings.resourceName")&&(i=[e.settings.get("settings.resourceName")])),i}}class l extends BITSMIST.v1.Organizer{static init(e,t){Object.defineProperty(e,"validators",{get(){return this._validators}}),Object.defineProperty(e,"validationResult",{get(){return this._validationResult}}),e.addValidator=function(e,t){return l._addValidator(this,e,t)},e._validators={},e._validationResult={}}static organize(e,t,r){switch(e){case"doCheckValidity":case"doReportValidity":let i=r.validationName;if(i){let s=BITSMIST.v1.Util.safeGet(r,"item"),a=t.settings.get("validations."+i+".rules"),n=t.settings.get("validations."+i+".handlerOptions"),o="doCheckValidity"===e?"checkValidity":"reportValidity";BITSMIST.v1.Util.assert(t._validators[i],`ValidationOrganizer.organize(): Validator not found. name=${t.name}, validationName=${i}`),t._validators[i][o](s,a,n)}break;default:let s=r.validations;s&&Object.keys(s).forEach((e=>{l._addValidator(t,e,s[e])}))}}static _addValidator(e,t,r){let i;return r.handlerClassName&&(i=BITSMIST.v1.ClassUtil.createObject(r.handlerClassName,e,t,r),e._validators[t]=i),i}}class c extends BITSMIST.v1.Organizer{static init(e,t){Object.defineProperty(e,"binds",{get(){return this._binds},set(e){c.update(this,e)}}),e.bindData=function(e){return c._bindData(this,e)},e.update=function(e){return c._update(this,e)},e._binds=new i}static organize(e,t,r){switch(e){case"afterAppend":c._bindData(t);break;case"afterFetch":let e=r.bindings;e&&c.setResource(t,e)}}static setResource(e,t){let r=t.resourceName;e._binds.replace(e.resources[r].item)}static update(e,t){e._binds.items=t,c._bindData(e)}static _bindData(e,t){let r=(t=t||e).querySelectorAll("[bm-bind]");r=Array.prototype.slice.call(r,0),r.forEach((t=>{e._binds.bindTo(t)}))}}class u extends BITSMIST.v1.Organizer{static init(e,t){e._plugins={}}static organize(e,t,r){let i=r.plugins;i&&Object.keys(i).forEach((e=>{u._addPlugin(t,e,i[e])}))}static _addPlugin(e,t,r){let i="className"in(r=Object.assign({},r))?r.className:t,s=null;return s=BITSMIST.v1.ClassUtil.createObject(i,e,r),e._plugins[t]=s,s}}class d extends BITSMIST.v1.Organizer{static init(e,t){e.__isComposing=!1}static organize(e,t,r){let i=r.keys;if(i){let e=d.__getActions(i);t.addEventListener("keydown",(function(e){d.onKeyDown.call(this,e,t)})),t.addEventListener("keyup",(function(r){d.onKeyUp.call(this,r,t,i,e)})),Object.keys(i).forEach((e=>{d.__initButtons(t,e,i[e])}))}}static onKeyDown(e,t){t.__isComposing=229===e.keyCode}static onKeyUp(e,t,r,i){if(t.__isComposing)return;let s=e.key?e.key:d.__getKeyfromKeyCode(e.keyCode);switch(s){case"Esc":s="Escape";break;case"Down":s="ArrowDown";break;case"Up":s="ArrowUp";break;case"Left":s="ArrowLeft";break;case"Right":s="ArrowRight"}s=s.toLowerCase(),i[s]&&i[s].handler.call(this,e,t,i[s].option)}static _defaultSubmit(e,t,r){t.submit().then((()=>{t.cancelSubmit||(t._isModal&&(t.modalResult.result=!0),r&&r.autoClose&&t.close())}))}static _defaultCancel(e,t,r){t.close()}static _defaultClear(e,t,r){let i;this.hasAttribute("bm-cleartarget")&&(i=this.getAttribute("bm-cleartarget")),t.clear(i)}static __getKeyfromKeyCode(e){let t;if(13===e)t="Enter";else t=String.fromCharCode(e);return t}static __initButtons(e,t,r){if(r&&r.rootNode){let i=r.handler?r.handler:d.__getDefaultHandler(t),s=e.querySelectorAll(r.rootNode);s=Array.prototype.slice.call(s,0),s.forEach((t=>{t.addEventListener("click",(function(t){i.call(this,t,e,r)}))}))}}static __getActions(e){let t={};return Object.keys(e).forEach((r=>{let i=Array.isArray(e[r].key)?e[r].key:[e[r].key];for(let s=0;s<i.length;s++)t[i[s]]={},t[i[s]].type=r,t[i[s]].handler=e[r].handler?e[r].handler:d.__getDefaultHandler(r),t[i[s]].option=e[r]})),t}static __getDefaultHandler(e){let t;switch(e){case"submit":t=d._defaultSubmit;break;case"clear":t=d._defaultClear;break;case"cancel":t=d._defaultCancel}return t}}class h extends BITSMIST.v1.Organizer{static organize(e,t,r){let i=r.chains;i&&Object.keys(i).forEach((e=>{t.addEventHandler(e,{handler:h.onDoOrganize,options:i[e]})}))}static unorganize(e,t,r){let i=r.chains;i&&Object.keys(i).forEach((e=>{t.removeEventHandler(e,{handler:h.onDoOrganize,options:i[e]})}))}static onDoOrganize(e,t,r){let i=r.component,s=r.options,a=[],n=Promise.resolve();for(let e=0;e<s.length;e++){let r=s[e].method||"refresh",o=s[e].state||"started",l=s[e].sync,c=document.querySelectorAll(s[e].rootNode);c=Array.prototype.slice.call(c,0),BITSMIST.v1.Util.assert(c.length>0,`ChainOrganizer.onDoOrganizer(): Node not found. name=${i.name}, eventName=${t.type}, rootNode=${s[e].rootNode}, method=${r}`),n=l?n.then((()=>h.__execTarget(i,c,r,o))):h.__execTarget(i,c,r,o),a.push(n)}return n.then((()=>Promise.all(a)))}static __execTarget(e,t,r,i){let s=[];return t.forEach((t=>{let a=e.waitFor([{object:t,state:i}]).then((()=>t[r]({sender:e})));s.push(a)})),Promise.all(s)}}class g extends BITSMIST.v1.Organizer{static init(e,t){Object.defineProperty(e,"modalResult",{get(){return this._modalResult}}),Object.defineProperty(e,"isModal",{get(){return this._isModal}}),e.open=function(e){return g._open(this,e)},e.openModal=function(e){return g._openModal(this,e)},e.close=function(e){return g._close(this,e)},e._isModal=!1,e._modalResult,e._modalPromise}static organize(e,t,r){switch(r.dialog,e){case"beforeStart":t.settings.set("settings.autoRefresh",!1),t.settings.set("settings.autoRefreshOnOpen",!0),t.settings.set("settings.autoSetup",!1),t.settings.set("settings.autoSetupOnOpen",!0);break;case"afterStart":t.settings.get("settings.autoOpen")&&t.open()}}static _open(e,t){return t=Object.assign({},t),Promise.resolve().then((()=>e.trigger("beforeOpen",t))).then((()=>{if(BITSMIST.v1.Util.safeGet(t,"autoSetupOnOpen",e.settings.get("settings.autoSetupOnOpen")))return e.setup(t)})).then((()=>{if(BITSMIST.v1.Util.safeGet(t,"autoRefreshOnOpen",e.settings.get("settings.autoRefreshOnOpen")))return e.refresh(t)})).then((()=>e.trigger("doOpen",t))).then((()=>{let t=e.settings.get("settings.autoFocus");if(t){let r=!0===t?e:e.querySelector(t);r&&r.focus()}})).then((()=>e.trigger("afterOpen",t))).then((()=>{}))}static _openModal(e,t){return new Promise(((r,i)=>{e._isModal=!0,e._modalResult={result:!1},e._modalPromise={resolve:r,reject:i},g._open(e,t)}))}static _close(e,t){return t=Object.assign({},t),Promise.resolve().then((()=>e.trigger("beforeClose",t))).then((()=>e.trigger("doClose",t))).then((()=>e.trigger("afterClose",t))).then((()=>{e._isModal&&e._modalPromise.resolve(e._modalResult)})).then((()=>{}))}}class p extends BITSMIST.v1.Organizer{static globalInit(){p._defaults=new BITSMIST.v1.ChainableStore,p._store=new e({chain:p._defaults,filter:p._filter,async:!0}),p.__loaded={},p.__loaded.promise=new Promise(((e,t)=>{p.__loaded.resolve=e,p.__loaded.reject=t}))}static init(e,t){p._store.subscribe(e.name+"_"+e.uniqueId,p._triggerEvent.bind(e),{targets:BITSMIST.v1.Util.safeGet(t,"preferences.targets")})}static organize(e,t,r){let i,s=Promise.resolve();return BITSMIST.v1.Util.safeGet(r,"preferences.defaults")&&(p._defaults.items=t.settings.get("preferences.defaults")),BITSMIST.v1.Util.safeGet(r,"preferences.settings.load")&&(s=t.resources.preferences.get().then((e=>{p._store.merge(e),p.__loaded.resolve()}))),s.then((()=>{let e=t.settings.get("system.preferenceTimeout",1e4);return i=setTimeout((()=>{throw new ReferenceError(`Time out waiting for loading preferences. name=${t.name}`)}),e),p.__loaded.promise})).then((()=>{clearTimeout(i)}))}static _triggerEvent(e){let t=this.settings.get("preferences.settings.eventName","doSetup");return this.trigger(t,{sender:p,item:e})}static _filter(e,t){let r=!1,i=t.targets;if("*"===i)r=!0;else{i=Array.isArray(i)?i:[i];for(let t=0;t<i.length;t++)if(e[i[t]]){r=!0;break}}return r}}class m{constructor(e,t,r){this._resourceName=t,this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},r)}),this._data,this._name="ResourceHandler",this._items=[],this._item={},this._target={},this._currentIndex=0}get name(){return this._name}set name(e){this._name=e}get resourceName(){return this._resourceName}set resourceName(e){this._resourceName=e}get target(){return this._target}get data(){return this._data}set data(e){this._data=e,this._items=this.__reshapeItems(e),this._item=Array.isArray(this._items)?this._items[this._currentIndex]:this._items}get items(){return this._items}get item(){return this._item}get options(){return this._options}get(e,t){return Promise.resolve().then((()=>this._get(e,t))).then((e=>(e&&(this.data=e),this._data)))}delete(e,t){return Promise.resolve().then((()=>this._delete(e,t)))}post(e,t,r){return t=this.__reshapeData(t),Promise.resolve().then((()=>this._post(e,t,r)))}put(e,t,r){return t=this.__reshapeData(t),Promise.resolve().then((()=>this._put(e,t,r)))}getText(e){let t=e,r=this._options.get("fieldOptions.text");return this._items&&e in this._items&&(t=this._items[e][r]),t}getItem(e){let t;return this._items&&e in this._items&&(t=this._items[e]),t}_get(e,t){}_delete(e,t){}_post(e,t,r){}_put(e,t,r){}__reshapeItems(e){let t=this._options.get("fieldOptions.items"),r=t?BITSMIST.v1.Util.safeGet(e,t):e;if(this._options.get("reshapeOptions.get.reshape")){r=this._options.get("reshapeOptions.get.reshaper",this.__reshaper_get.bind(this))(r)}return r}__reshapeData(e){if(this._options.get("reshapeOptions.put.reshape")){let t=this._options.get("reshapeOptions.put.reshaper",(()=>e));e=t(e)}return e}__reshaper_get(e){let t=this._options.get("fieldOptions.id");return e.reduce(((e,r)=>(e[r[t]]=r,e)),{})}}class _{constructor(e,t,r){this._name=t,this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},r)})}get name(){return this._name}set name(e){this._name=e}get options(){return this._options}static createValidationResult(e,t,r,i,s){return{key:e,value:t,message:_._getFunctionValue(e,t,"message",r),fix:_._getFunctionValue(e,t,"fix",r),failed:i,extras:s}}static validate(e,t,r){t=t||{};let i={};return(r=r||{}).allowList&&Object.keys(e).forEach((s=>{if(-1===r.allowList.indexOf(s)){let r=[{rule:"allowList",validity:"notAllowed"}];i[s]=_.createValidationResult(s,e[s],t[s],r)}})),r.allowOnlyInRules&&Object.keys(e).forEach((r=>{if(!(r in t)){let s=[{rule:"allowList",validity:"notAllowed"}];i[r]=_.createValidationResult(r,e[r],t[r],s)}})),r.disallowList&&Object.keys(e).forEach((s=>{if(r.disallowList.indexOf(s)>-1){let r=[{rule:"disallowList",validity:"disallowed"}];i[s]=_.createValidationResult(s,e[s],t[s],r)}})),Object.keys(t).forEach((r=>{if("constraints"in t[r]&&t[r].constraints&&"required"in t[r].constraints&&t[r].constraints.required&&!(r in e)){let s=[{rule:"required",validity:"valueMissing"}];i[r]=_.createValidationResult(r,e[r],t[r],s)}})),i}checkValidity(e,t,r){}reportValidity(e,t){}static _getFunctionValue(e,t,r,i){let s;return i&&r in i&&(s="function"==typeof i[r]?i[r](e,t,i):i[r]),s}}class f extends _{static validate(e,t){let i={};return BITSMIST.v1.Util.assert(e,"FormValidationHandler.checkValidity(): Form tag does not exist.",TypeError),BITSMIST.v1.Util.assert(e.checkValidity,"FormValidationHandler.checkValidity(): check validity not supported.",TypeError),BITSMIST.v1.Util.scopedSelectorAll(e,"input:not([novalidate])").forEach((e=>{let s=e.getAttribute("bm-bind"),a=r.getValue(e),n=t&&t[s]?t[s]:null,o=f._validateValue(e,s,a,n);o.length>0&&(i[s]=_.createValidationResult(s,a,n,o,{element:e}),i.message=i.message||e.validationMessage)})),i}checkValidity(e,t,i){let s,a={},n=this._component.querySelector("form");if(t||i){let e=r.getFields(n);a=_.validate(e,t,i)}s=f.validate(n,t);let o=BITSMIST.v1.Util.deepMerge(a,s);this._component.validationResult.result=!(Object.keys(o).length>0),this._component.validationResult.invalids=o}reportValidity(e,t){let r=this._component.querySelector("form");BITSMIST.v1.Util.assert(r,"FormValidationHandler.reportValidity(): Form tag does not exist.",TypeError),BITSMIST.v1.Util.assert(r.reportValidity,"FormValidationHandler.reportValidity(): Report validity not supported.",TypeError),r.reportValidity()}static _validateValue(e,t,r,i){let s=[],a=e.validity;if(!a.valid)for(const e in a)"valid"!==e&&a[e]&&s.push({validity:e});return s}}class S extends _{static validate(e,t){let r={};return t&&Object.keys(e).forEach((i=>{if(t[i]){let s=S._validateValue(i,e[i],t[i]);s.length>0&&(r[i]=_.createValidationResult(i,e[i],t[i],s))}})),r}checkValidity(e,t,r){let i=_.validate(e,t,r),s=S.validate(e,t),a=BITSMIST.v1.Util.deepMerge(i,s);this._component.validationResult.result=!(Object.keys(a).length>0),this._component.validationResult.invalids=a}reportValidity(e,t){}static _validateValue(e,t,r){let i=[];return r&&r.constraints&&Object.keys(r.constraints).forEach((s=>{let a=S._checkConstraint(e,t,s,r.constraints[s]);a&&i.push(a)})),i}static _checkConstraint(e,t,r,i){let s,a,n;switch(r){case"type":s=S._checkType(e,t,r,i);break;case"required":t||(s={rule:"required",validity:"valueMissing"});break;case"minlength":a=String(t).length,a<i&&(s={rule:"minlength",validity:"tooShort(min:"+i+")"});break;case"maxlength":a=String(t).length,a>i&&(s={rule:"maxlength",validity:"tooLong(max:"+i+")"});break;case"min":n=parseInt(t),n<i&&(s={rule:"min",validity:"rangeUnderflow(min:"+i+")"});break;case"max":n=parseInt(t),n>i&&(s={rule:"max",validity:"rangeOverflow(max:"+i+")"});break;case"pattern":new RegExp(i).test(t)||(s={rule:"pattern",validity:"patternMismatch(pattern:"+i+")"});break;case"valids":-1===i.indexOf(t)&&(s={rule:"valids",validity:"validsMismatch"});break;case"custom":i(e,t,i)||(s={rule:"custom",validity:"customMismatch"})}return s}static _checkType(e,t,r,i){let s;if(t)switch(i){case"object":"object"!=typeof t&&(s={rule:"type",validity:"typeMismatch(object)"});break;case"function":"function"!=typeof t&&(s={rule:"type",validity:"typeMismatch(function)"});break;case"string":"string"!=typeof t&&(s={rule:"type",validity:"typeMismatch(string)"});break;case"number":let e=parseInt(t);isNaN(e)&&(s={rule:"type",validity:"typeMismatch(number)"})}return s}}function b(e){return Reflect.construct(BITSMIST.v1.Component,[e],this.constructor)}function v(){return Reflect.construct(BITSMIST.v1.Component,[],this.constructor)}function T(){return Reflect.construct(HTMLElement,[],this.constructor)}function y(){return Reflect.construct(HTMLElement,[],this.constructor)}function I(e){return Reflect.construct(BITSMIST.v1.Component,[e],this.constructor)}BITSMIST.v1.ClassUtil.inherit(b,BITSMIST.v1.Component),Object.defineProperty(b.prototype,"item",{get(){return this._item},set(e){this._item=e}}),Object.defineProperty(b.prototype,"cancelSubmit",{get(){return this._cancelSubmit},set(e){this._cancelSubmit=e}}),b.prototype.start=function(e){return this._item={},this._cancelSubmit=!1,e=Object.assign({},e,{settings:{autoClear:!0},organizers:{ValidationOrganizer:{settings:{attach:!0}}}}),BITSMIST.v1.Component.prototype.start.call(this,e)},b.prototype.switchTemplate=function(e,t){return BITSMIST.v1.Component.prototype.switchTemplate.call(this,e,t).then((()=>{r.hideConditionalElements(this)}))},b.prototype.build=function(e,t,i){r.build(e,t,i)},b.prototype.clear=function(e){return r.clearFields(this,e)},b.prototype.fill=function(e){let t="rootNode"in(e=Object.assign({},e))?this.querySelector(e.rootNode):this;BITSMIST.v1.Util.safeGet(e,"autoClear",this.settings.get("settings.autoClear"))&&this.clear();let i="item"in e?e.item:this._item;return Promise.resolve().then((()=>(r.showConditionalElements(this,i),this.trigger("beforeFill",e)))).then((()=>(r.setFields(t,i,{masters:this.resources,triggerEvent:"change"}),this.trigger("afterFill",e))))},b.prototype.validate=function(e){return e=Object.assign({},e),this.validationResult.result=!0,Promise.resolve().then((()=>this.trigger("beforeValidate"))).then((()=>this.callOrganizers("doCheckValidity",{item:this._item,validationName:this.settings.get("settings.validationName")}))).then((()=>this.trigger("doValidate"))).then((()=>this.trigger("afterValidate"))).then((()=>{if(!this.validationResult.result)return this._cancelSubmit=!0,Promise.resolve().then((()=>this.callOrganizers("doReportValidity",{validationName:this.settings.get("settings.validationName")}))).then((()=>this.trigger("doReportValidatidy")))}))},b.prototype.submit=function(e){return e=Object.assign({},e),this._cancelSubmit=!1,this._item=r.getFields(this),Promise.resolve().then((()=>this.validate(e))).then((()=>{if(!this._cancelSubmit)return Promise.resolve().then((()=>this.trigger("beforeSubmit",{item:this._item}))).then((()=>this.callOrganizers("doSubmit",e))).then((()=>this.trigger("doSubmit",{item:this._item}))).then((()=>this.trigger("afterSubmit",{item:this._item})))}))},BITSMIST.v1.ClassUtil.inherit(v,BITSMIST.v1.Component),Object.defineProperty(v.prototype,"rows",{get(){return this._rows}}),Object.defineProperty(v.prototype,"items",{get(){return this._items},set(e){this._items=e}}),v.prototype.start=function(e){return this._items=[],this._activeRowTemplateName="",this._listRootNode,this._rows,e=Object.assign({},e,{settings:{autoClear:!0}}),BITSMIST.v1.Component.prototype.start.call(this,e)},v.prototype.switchTemplate=function(e,t){return BITSMIST.v1.Component.prototype.switchTemplate.call(this,e,t).then((()=>(r.hideConditionalElements(this),this.switchRowTemplate(this.settings.get("settings.rowTemplateName")))))},v.prototype.switchRowTemplate=function(e,t){return t=Object.assign({},t),this._activeRowTemplateName===e?Promise.resolve():Promise.resolve().then((()=>this.addTemplate(e))).then((()=>{this._activeRowTemplateName=e})).then((()=>this.callOrganizers("afterRowAppend",this.settings.items))).then((()=>this.trigger("afterRowAppend",t))).then((()=>{}))},v.prototype.clear=function(){this._listRootNode.innerHTML=""},v.prototype.fill=function(e){e=Object.assign({},e);let t=this._getBuilder(e),i=document.createDocumentFragment();return this._rows=[],this._listRootNode=this.querySelector(this.settings.get("settings.listRootNode")),BITSMIST.v1.Util.assert(this._listRootNode,`List.fill(): List root node not found. name=${this.name}, listRootNode=${this.settings.get("settings.listRootNode")}`),Promise.resolve().then((()=>(r.showConditionalElements(this,this.item),this.trigger("beforeFill",e)))).then((()=>t.call(this,i,this._items))).then((()=>{BITSMIST.v1.Util.safeGet(e,"autoClear",this.settings.get("settings.autoClear"))&&this.clear()})).then((()=>{this._listRootNode.appendChild(i)})).then((()=>this.trigger("afterFill",e))).then((()=>{}))},v.prototype._getBuilder=function(e){return BITSMIST.v1.Util.safeGet(e,"async",this.settings.get("settings.async",!0))?this._buildAsync:this._buildSync},v.prototype._buildSync=function(e,t){BITSMIST.v1.Util.assert(this._templates[this._activeRowTemplateName],`List._buildSync(): Row template not loaded yet. name=${this.name}, rowTemplateName=${this._activeRowTemplateName}`);let r=Promise.resolve(),i=this.settings.get("rowevents"),s=this.templates[this._activeRowTemplateName].html;for(let a=0;a<t.length;a++)r=r.then((()=>this._appendRowSync(e,a,t[a],s,i)));return r},v.prototype._buildAsync=function(e,t){BITSMIST.v1.Util.assert(this.templates[this._activeRowTemplateName],`List._buildAsync(): Row template not loaded yet. name=${this.name}, rowTemplateName=${this._activeRowTemplateName}`);let r=this.settings.get("rowevents"),i=this.templates[this._activeRowTemplateName].html;for(let s=0;s<t.length;s++)this._appendRowAsync(e,s,t[s],i,r)},v.prototype._createRow=function(e){let t=document.createElement("div");t.innerHTML=e;let r=t.firstElementChild;return r.setAttribute("bm-powered",""),r},v.prototype._appendRowSync=function(e,t,i,s,a){this.triggerAsync("beforeBuildRow",{item:i});let n=Promise.resolve();n=n.then((()=>{let n=this._createRow(s);return e.appendChild(n),this._rows.push(n),a&&Object.keys(a).forEach((e=>{this.initEvents(e,a[e],n)})),Promise.resolve().then((()=>this.trigger("beforeFillRow",{item:i,no:t,element:n}))).then((()=>{r.showConditionalElements(n,i),r.setFields(n,i,{masters:this.resources})})).then((()=>this.trigger("afterFillRow",{item:i,no:t,element:n})))}))},v.prototype._appendRowAsync=function(e,t,i,s,a){this.triggerAsync("beforeBuildRow",{item:i});let n=this._createRow(s);e.appendChild(n),this._rows.push(n),a&&Object.keys(a).forEach((e=>{this.initEvents(e,a[e],n)})),this.triggerAsync("beforeFillRow",{item:i,no:t,element:n}),r.showConditionalElements(n,i),r.setFields(n,i,{masters:this.resources}),this.triggerAsync("afterFillRow",{item:i,no:t,element:n})},BITSMIST.v1.ClassUtil.inherit(T,BITSMIST.v1.Component),T.prototype.start=function(e){let t={settings:{name:"TagLoader"}};return e=e?BITSMIST.v1.Util.deepMerge(t,e):t,BITSMIST.v1.Component.prototype.start.call(this,e).then((()=>{"loading"!==document.readyState?BITSMIST.v1.LoaderOrganizer.load(document.body,this.settings):document.addEventListener("DOMContentLoaded",(()=>{BITSMIST.v1.LoaderOrganizer.load(document.body,this.settings)}))}))},customElements.define("bm-tagloader",T),BITSMIST.v1.ClassUtil.inherit(y,BITSMIST.v1.Component),y.prototype._getSettings=function(){return{settings:{name:"SettingManager",autoSetup:!1}}},customElements.define("bm-setting",y),BITSMIST.v1.ClassUtil.inherit(I,BITSMIST.v1.Component),I.prototype._getSettings=function(){return{settings:{autoRefresh:!1,autoSetup:!1,hasTemplate:!1,name:"PreferenceManager"},organizers:{ValidationOrganizer:{settings:{attach:!0}}}}},Object.defineProperty(I.prototype,"items",{get:()=>p._store.items}),I.prototype.get=function(e,t){return p._store.get(e,t)},I.prototype.set=function(e,t){this._validationResult.result=!0,Promise.resolve().then((()=>this.callOrganizers("doCheckValidity",{item:e,validationName:this._settings.get("settings.validationName")}))).then((()=>this.trigger("doValidate"))).then((()=>{if(!this._validationResult.result)throw new Error(`PreferenceManager.set(): Validation failed. values=${JSON.stringify(e)}, invalids=${JSON.stringify(this._validationResult.invalids)}`);if(p._store.set("",e,t),BITSMIST.v1.Util.safeGet(t,"autoSave",this.settings.get("preferences.settings.autoSave")))return this.resources.preferences.put("",p._store.localItems)}))},customElements.define("bm-preference",I),window.BITSMIST=window.BITSMIST||{},window.BITSMIST.v1=window.BITSMIST.v1||{},window.BITSMIST.v1.ObservableStore=e,window.BITSMIST.v1.BindableStore=i,BITSMIST.v1.OrganizerOrganizer.register("FileOrganizer",{object:s,targetWords:"files",targetEvents:["beforeStart","afterSpecLoad"],order:110}),BITSMIST.v1.OrganizerOrganizer.register("ErrorOrganizer",{object:a,targetWords:"errors",targetEvents:["beforeStart","afterSpecLoad"],order:120}),BITSMIST.v1.OrganizerOrganizer.register("ElementOrganizer",{object:n,targetWords:"elements",targetEvents:["beforeStart"],order:220}),BITSMIST.v1.OrganizerOrganizer.register("ResourceOrganizer",{object:o,targetWords:"resources",targetEvents:["beforeStart","afterSpecLoad","doFetch","doSubmit"],order:300}),BITSMIST.v1.OrganizerOrganizer.register("ValidationOrganizer",{object:l,targetWords:"validations",targetEvents:["beforeStart","afterSpecLoad","doCheckValidity","doReportValidity"],order:310}),BITSMIST.v1.OrganizerOrganizer.register("DatabindingOrganizer",{object:c,targetWords:"data",targetEvents:["afterAppend"],order:320}),BITSMIST.v1.OrganizerOrganizer.register("PluginOrganizer",{object:u,targetWords:"plugins",targetEvents:["beforeStart","afterSpecLoad"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("KeyOrganizer",{object:d,targetWords:"keys",targetEvents:["afterAppend"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("ChainOrganizer",{object:h,targetWords:"chains",targetEvents:["beforeStart","afterSpecLoad"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("DialogOrganizer",{object:g,targetWords:"dialog",targetEvents:["beforeStart","afterStart"],order:800}),BITSMIST.v1.OrganizerOrganizer.register("PreferenceOrganizer",{object:p,targetWords:"preferences",targetEvents:["beforeStart","afterSpecLoad"],order:900}),window.BITSMIST.v1.Plugin=class{constructor(e,t){this._component=e,this._options=new BITSMIST.v1.Store({items:Object.assign({},t)}),this._options.merge(this._getOptions()),this._options.set("name",this._options.get("name",this.constructor.name));let r=this._options.get("events",{});if(Object.keys(r).forEach((t=>{e.addEventHandler(t,r[t],null,this)})),this._options.get("expose")){let t=this;Object.defineProperty(e.__proto__,this._options.get("expose"),{get:()=>t})}}get name(){return this._options.get("name")}get component(){return this._component}set component(e){this._component=e}_getOptions(){return{}}},window.BITSMIST.v1.CookieResourceHandler=class extends m{constructor(e,t,r){super(e,t,Object.assign({autoLoad:!0},r)),this._name="CookieResourceHandler",this._cookieName=BITSMIST.v1.Util.safeGet(r,"cookieOptions.name","preferences")}_get(e,t){return this.__getCookie(this._cookieName)}_put(e,t,r){this.__setCookie(this._cookieName,t)}__getCookie(e){let t=document.cookie.split(";").reduce(((e,t)=>{const[r,i]=t.split("=");return r&&(e[r.trim()]=i?decodeURIComponent(i.trim()):void 0),e}),{});return t[e]?JSON.parse(t[e]):{}}__setCookie(e,t){let r=e+"="+encodeURIComponent(JSON.stringify(t))+"; ",i=this._options.get("cookieOptions");r+=Object.keys(i).reduce(((e,t)=>e+=t+"="+i[t]+"; "),""),document.cookie=r}},window.BITSMIST.v1.ApiResourceHandler=class extends m{constructor(e,t,r){super(e,t,r),this._name="ApiResourceHandler"}_get(e,t){let r="GET",i=this._getOption("headers",r),s=this._getOption("options",r),a=this._getOption("url",r),n=a.dataType,o=this._buildApiUrl(this._resourceName,e,t,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:o,method:r,headers:i,options:s}).then((e=>this._convertResponseData(e.responseText,n)))}_delete(e,t){let r="DELETE",i=this._getOption("headers",r),s=this._getOption("options",r),a=this._getOption("url",r);a.dataType;let n=this._buildApiUrl(this._resourceName,e,t,a);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:n,method:r,headers:i,options:s})}_post(e,t,r){let i="POST",s=this._getOption("headers",i),a=this._getOption("options",i),n=this._getOption("url",i),o=n.dataType,l=this._buildApiUrl(this._resourceName,e,r,n);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:l,method:i,headers:s,options:a,data:this._convertRequestData(t,o)})}_put(e,t,r){let i="PUT",s=this._getOption("headers",i),a=this._getOption("options",i),n=this._getOption("url",i),o=n.dataType,l=this._buildApiUrl(this._resourceName,e,r,n);return BITSMIST.v1.AjaxUtil.ajaxRequest({url:l,method:i,headers:s,options:a,data:this._convertRequestData(t,o)})}_convertRequestData(e,t){let r;return r=JSON.stringify(e),r}_convertResponseData(e,t){let r;return r=JSON.parse(e),r}_getOption(e,t){let r=this._options.get("ajaxOptions",{}),i=e in r&&"COMMON"in r[e]?r[e].COMMON:{},s=e in r&&t in r[e]?r[e][t]:{};return Object.assign(i,s)}_buildApiUrl(e,t,r,i){let s=i.baseUrl||this._component.settings.get("system.apiBaseUrl",""),a=i.scheme||"",n=i.host||"",o=i.dataType||"",l=i.version||"";return(i.format||"").replace("@scheme@",a).replace("@host@",n).replace("@baseUrl@",s).replace("@resource@",e).replace("@id@",t).replace("@dataType@",o).replace("@query@",this._buildUrlQuery(r)).replace("@version@",l)}_buildUrlQuery(e){let t="";return e&&(t=Object.keys(e).reduce(((t,r)=>(Array.isArray(e[r])?t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r].join())+"&":e[r]&&(t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])+"&"),t)),"")),t?"?"+t.slice(0,-1):""}},window.BITSMIST.v1.ObjectResourceHandler=class extends m{constructor(e,t,r){super(e,t,Object.assign({autoLoad:!0},r)),this._name="ObjectResourceHandler",r.items&&(this.data=r.items)}_get(e,t){return this._data}_put(e,t,r){this.data=t}},window.BITSMIST.v1.LinkedResourceHandler=class extends m{constructor(e,t,r){super(e,t,Object.assign({autoLoad:!0},r)),this._name="LinkedResourceHandler",this._ref}get target(){return this._ref.target}get data(){return this._ref.data}set data(e){this._ref.data=e}get items(){return this._ref.items}get item(){return this._ref.item}_get(e,t){let r=this._options.items,i=r.rootNode,s=r.resourceName;r.state,this._ref=document.querySelector(i).resources[s]}getText(e){return this._ref.getText(e)}getItem(e){return this._ref.getItem(e)}},window.BITSMIST.v1.ValidationHandler=_,window.BITSMIST.v1.HTML5FormValidationHandler=f,window.BITSMIST.v1.ObjectValidationHandler=S,window.BITSMIST.v1.FormatterUtil=t,window.BITSMIST.v1.Form=b,window.BITSMIST.v1.List=v}();
